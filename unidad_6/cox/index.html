<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regresión de Cox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#modelo-de-cox" id="toc-modelo-de-cox" class="nav-link" data-scroll-target="#modelo-de-cox">Modelo de Cox</a>
  <ul class="collapse">
  <li><a href="#estimación-e-interpretación-de-los-coeficientes-del-modelo-de-cox" id="toc-estimación-e-interpretación-de-los-coeficientes-del-modelo-de-cox" class="nav-link" data-scroll-target="#estimación-e-interpretación-de-los-coeficientes-del-modelo-de-cox">Estimación e interpretación de los coeficientes del modelo de Cox</a></li>
  </ul></li>
  <li><a href="#cómo-construir-un-modelo-de-cox-trabajemos-con-un-ejemplo" id="toc-cómo-construir-un-modelo-de-cox-trabajemos-con-un-ejemplo" class="nav-link" data-scroll-target="#cómo-construir-un-modelo-de-cox-trabajemos-con-un-ejemplo">¿Cómo construir un Modelo de Cox? Trabajemos con un ejemplo</a>
  <ul class="collapse">
  <li><a href="#analicemos-nuestro-modelo" id="toc-analicemos-nuestro-modelo" class="nav-link" data-scroll-target="#analicemos-nuestro-modelo">Analicemos nuestro modelo</a></li>
  <li><a href="#algunas-alternativas" id="toc-algunas-alternativas" class="nav-link" data-scroll-target="#algunas-alternativas">Algunas alternativas</a></li>
  </ul></li>
  <li><a href="#predicción-de-la-curva-de-supervivencia" id="toc-predicción-de-la-curva-de-supervivencia" class="nav-link" data-scroll-target="#predicción-de-la-curva-de-supervivencia">Predicción de la curva de supervivencia</a></li>
  <li><a href="#calidad-de-ajuste-de-un-modelo" id="toc-calidad-de-ajuste-de-un-modelo" class="nav-link" data-scroll-target="#calidad-de-ajuste-de-un-modelo">Calidad de ajuste de un modelo</a></li>
  <li><a href="#análisis-de-residuos" id="toc-análisis-de-residuos" class="nav-link" data-scroll-target="#análisis-de-residuos">Análisis de residuos</a>
  <ul class="collapse">
  <li><a href="#residuos-de-schoenfeld" id="toc-residuos-de-schoenfeld" class="nav-link" data-scroll-target="#residuos-de-schoenfeld">Residuos de Schoenfeld</a></li>
  <li><a href="#residuos-martingale" id="toc-residuos-martingale" class="nav-link" data-scroll-target="#residuos-martingale">Residuos Martingale</a></li>
  </ul></li>
  <li><a href="#modelo-de-cox-estratificado" id="toc-modelo-de-cox-estratificado" class="nav-link" data-scroll-target="#modelo-de-cox-estratificado">Modelo de Cox estratificado</a></li>
  <li><a href="#modelo-de-cox-extendido" id="toc-modelo-de-cox-extendido" class="nav-link" data-scroll-target="#modelo-de-cox-extendido">Modelo de Cox extendido</a></li>
  <li><a href="#análisis-de-supervivencia-más-complejos" id="toc-análisis-de-supervivencia-más-complejos" class="nav-link" data-scroll-target="#análisis-de-supervivencia-más-complejos">Análisis de supervivencia más complejos</a></li>
  <li><a href="#consideraciones-sobre-el-tamaño-de-la-muestra" id="toc-consideraciones-sobre-el-tamaño-de-la-muestra" class="nav-link" data-scroll-target="#consideraciones-sobre-el-tamaño-de-la-muestra">Consideraciones sobre el tamaño de la muestra</a></li>
  <li><a href="#bibliografía" id="toc-bibliografía" class="nav-link" data-scroll-target="#bibliografía">Bibliografía</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Regresión de Cox</strong></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<div style="text-align: center;">
<p>Este material es parte de la <strong>Unidad 6 del Curso de Epidemiología - Nivel Avanzado del Instituto Nacional de Epidemiología “Dr.&nbsp;Juan H. Jara” - ANLIS</strong></p>
<p><a href="https://datos-ine.github.io/EpiAvanzada/unidad_6/cox">Regresión de Cox</a> por <a href="http://www.ine.gov.ar/">Andrea Silva y Micaela Gauto</a> bajo licencia <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1">CC BY-NC 4.0</a> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy43ODUiIGN5PSIyOC41MDEiIHI9IjI4LjgzNiIvPg0KCTxwYXRoIGQ9Ik0zNy40NDEtMy41YzguOTUxLDAsMTYuNTcyLDMuMTI1LDIyLjg1Nyw5LjM3MmMzLjAwOCwzLjAwOSw1LjI5NSw2LjQ0OCw2Ljg1NywxMC4zMTQNCgkJYzEuNTYxLDMuODY3LDIuMzQ0LDcuOTcxLDIuMzQ0LDEyLjMxNGMwLDQuMzgxLTAuNzczLDguNDg2LTIuMzE0LDEyLjMxM2MtMS41NDMsMy44MjgtMy44Miw3LjIxLTYuODI4LDEwLjE0Mw0KCQljLTMuMTIzLDMuMDg1LTYuNjY2LDUuNDQ4LTEwLjYyOSw3LjA4NmMtMy45NjEsMS42MzgtOC4wNTcsMi40NTctMTIuMjg1LDIuNDU3cy04LjI3Ni0wLjgwOC0xMi4xNDMtMi40MjkNCgkJYy0zLjg2Ni0xLjYxOC03LjMzMy0zLjk2MS0xMC40LTcuMDI3Yy0zLjA2Ny0zLjA2Ni01LjQtNi41MjQtNy0xMC4zNzJTNS41LDMyLjc2Nyw1LjUsMjguNWMwLTQuMjI5LDAuODA5LTguMjk1LDIuNDI4LTEyLjINCgkJYzEuNjE5LTMuOTA1LDMuOTcyLTcuNCw3LjA1Ny0xMC40ODZDMjEuMDgtMC4zOTQsMjguNTY1LTMuNSwzNy40NDEtMy41eiBNMzcuNTU3LDIuMjcyYy03LjMxNCwwLTEzLjQ2NywyLjU1My0xOC40NTgsNy42NTcNCgkJYy0yLjUxNSwyLjU1My00LjQ0OCw1LjQxOS01LjgsOC42Yy0xLjM1NCwzLjE4MS0yLjAyOSw2LjUwNS0yLjAyOSw5Ljk3MmMwLDMuNDI5LDAuNjc1LDYuNzM0LDIuMDI5LDkuOTEzDQoJCWMxLjM1MywzLjE4MywzLjI4NSw2LjAyMSw1LjgsOC41MTZjMi41MTQsMi40OTYsNS4zNTEsNC4zOTksOC41MTUsNS43MTVjMy4xNjEsMS4zMTQsNi40NzYsMS45NzEsOS45NDMsMS45NzENCgkJYzMuNDI4LDAsNi43NS0wLjY2NSw5Ljk3My0xLjk5OWMzLjIxOS0xLjMzNSw2LjEyMS0zLjI1Nyw4LjcxMy01Ljc3MWM0Ljk5LTQuODc2LDcuNDg0LTEwLjk5LDcuNDg0LTE4LjM0NA0KCQljMC0zLjU0My0wLjY0OC02Ljg5NS0xLjk0My0xMC4wNTdjLTEuMjkzLTMuMTYyLTMuMTgtNS45OC01LjY1NC04LjQ1OEM1MC45ODQsNC44NDQsNDQuNzk1LDIuMjcyLDM3LjU1NywyLjI3MnogTTM3LjE1NiwyMy4xODcNCgkJbC00LjI4NywyLjIyOWMtMC40NTgtMC45NTEtMS4wMTktMS42MTktMS42ODUtMmMtMC42NjctMC4zOC0xLjI4Ni0wLjU3MS0xLjg1OC0wLjU3MWMtMi44NTYsMC00LjI4NiwxLjg4NS00LjI4Niw1LjY1Nw0KCQljMCwxLjcxNCwwLjM2MiwzLjA4NCwxLjA4NSw0LjExM2MwLjcyNCwxLjAyOSwxLjc5MSwxLjU0NCwzLjIwMSwxLjU0NGMxLjg2NywwLDMuMTgxLTAuOTE1LDMuOTQ0LTIuNzQzbDMuOTQyLDINCgkJYy0wLjgzOCwxLjU2My0yLDIuNzkxLTMuNDg2LDMuNjg2Yy0xLjQ4NCwwLjg5Ni0zLjEyMywxLjM0My00LjkxNCwxLjM0M2MtMi44NTcsMC01LjE2My0wLjg3NS02LjkxNS0yLjYyOQ0KCQljLTEuNzUyLTEuNzUyLTIuNjI4LTQuMTktMi42MjgtNy4zMTNjMC0zLjA0OCwwLjg4Ni01LjQ2NiwyLjY1Ny03LjI1N2MxLjc3MS0xLjc5LDQuMDA5LTIuNjg2LDYuNzE1LTIuNjg2DQoJCUMzMi42MDQsMTguNTU4LDM1LjQ0MSwyMC4xMDEsMzcuMTU2LDIzLjE4N3ogTTU1LjYxMywyMy4xODdsLTQuMjI5LDIuMjI5Yy0wLjQ1Ny0wLjk1MS0xLjAyLTEuNjE5LTEuNjg2LTINCgkJYy0wLjY2OC0wLjM4LTEuMzA3LTAuNTcxLTEuOTE0LTAuNTcxYy0yLjg1NywwLTQuMjg3LDEuODg1LTQuMjg3LDUuNjU3YzAsMS43MTQsMC4zNjMsMy4wODQsMS4wODYsNC4xMTMNCgkJYzAuNzIzLDEuMDI5LDEuNzg5LDEuNTQ0LDMuMjAxLDEuNTQ0YzEuODY1LDAsMy4xOC0wLjkxNSwzLjk0MS0yLjc0M2w0LDJjLTAuODc1LDEuNTYzLTIuMDU3LDIuNzkxLTMuNTQxLDMuNjg2DQoJCWMtMS40ODYsMC44OTYtMy4xMDUsMS4zNDMtNC44NTcsMS4zNDNjLTIuODk2LDAtNS4yMDktMC44NzUtNi45NDEtMi42MjljLTEuNzM2LTEuNzUyLTIuNjAyLTQuMTktMi42MDItNy4zMTMNCgkJYzAtMy4wNDgsMC44ODUtNS40NjYsMi42NTgtNy4yNTdjMS43Ny0xLjc5LDQuMDA4LTIuNjg2LDYuNzEzLTIuNjg2QzUxLjExNywxOC41NTgsNTMuOTM4LDIwLjEwMSw1NS42MTMsMjMuMTg3eiIvPg0KPC9nPg0KPC9zdmc+DQo=" class="img-fluid" style="width:4.0%"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy42MzciIGN5PSIyOC44MDYiIHI9IjI4LjI3NiIvPg0KCTxnPg0KCQk8cGF0aCBkPSJNMzcuNDQzLTMuNWM4Ljk4OCwwLDE2LjU3LDMuMDg1LDIyLjc0Miw5LjI1N0M2Ni4zOTMsMTEuOTY3LDY5LjUsMTkuNTQ4LDY5LjUsMjguNWMwLDguOTkxLTMuMDQ5LDE2LjQ3Ni05LjE0NSwyMi40NTYNCgkJCUM1My44NzksNTcuMzE5LDQ2LjI0Miw2MC41LDM3LjQ0Myw2MC41Yy04LjY0OSwwLTE2LjE1My0zLjE0NC0yMi41MTQtOS40M0M4LjY0NCw0NC43ODQsNS41LDM3LjI2Miw1LjUsMjguNQ0KCQkJYzAtOC43NjEsMy4xNDQtMTYuMzQyLDkuNDI5LTIyLjc0MkMyMS4xMDEtMC40MTUsMjguNjA0LTMuNSwzNy40NDMtMy41eiBNMzcuNTU3LDIuMjcyYy03LjI3NiwwLTEzLjQyOCwyLjU1My0xOC40NTcsNy42NTcNCgkJCWMtNS4yMiw1LjMzNC03LjgyOSwxMS41MjUtNy44MjksMTguNTcyYzAsNy4wODYsMi41OSwxMy4yMiw3Ljc3LDE4LjM5OGM1LjE4MSw1LjE4MiwxMS4zNTIsNy43NzEsMTguNTE0LDcuNzcxDQoJCQljNy4xMjMsMCwxMy4zMzQtMi42MDcsMTguNjI5LTcuODI4YzUuMDI5LTQuODM4LDcuNTQzLTEwLjk1Miw3LjU0My0xOC4zNDNjMC03LjI3Ni0yLjU1My0xMy40NjUtNy42NTYtMTguNTcxDQoJCQlDNTAuOTY3LDQuODI0LDQ0Ljc5NSwyLjI3MiwzNy41NTcsMi4yNzJ6IE00Ni4xMjksMjAuNTU3djEzLjA4NWgtMy42NTZ2MTUuNTQyaC05Ljk0NFYzMy42NDNoLTMuNjU2VjIwLjU1Nw0KCQkJYzAtMC41NzIsMC4yLTEuMDU3LDAuNTk5LTEuNDU3YzAuNDAxLTAuMzk5LDAuODg3LTAuNiwxLjQ1Ny0wLjZoMTMuMTQ0YzAuNTMzLDAsMS4wMSwwLjIsMS40MjgsMC42DQoJCQlDNDUuOTE4LDE5LjUsNDYuMTI5LDE5Ljk4Niw0Ni4xMjksMjAuNTU3eiBNMzMuMDQyLDEyLjMyOWMwLTMuMDA4LDEuNDg1LTQuNTE0LDQuNDU4LTQuNTE0czQuNDU3LDEuNTA0LDQuNDU3LDQuNTE0DQoJCQljMCwyLjk3MS0xLjQ4Niw0LjQ1Ny00LjQ1Nyw0LjQ1N1MzMy4wNDIsMTUuMywzMy4wNDIsMTIuMzI5eiIvPg0KCTwvZz4NCjwvZz4NCjwvc3ZnPg0K" class="img-fluid" style="width:4.0%"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy40NyIgY3k9IjI4LjczNiIgcj0iMjkuNDcxIi8+DQoJPGc+DQoJCTxwYXRoIGQ9Ik0zNy40NDItMy41YzguOTksMCwxNi41NzEsMy4wODUsMjIuNzQzLDkuMjU2QzY2LjM5MywxMS45MjgsNjkuNSwxOS41MDksNjkuNSwyOC41YzAsOC45OTItMy4wNDgsMTYuNDc2LTkuMTQ1LDIyLjQ1OA0KCQkJQzUzLjg4LDU3LjMyLDQ2LjI0MSw2MC41LDM3LjQ0Miw2MC41Yy04LjY4NiwwLTE2LjE5LTMuMTYyLTIyLjUxMy05LjQ4NUM4LjY0NCw0NC43MjgsNS41LDM3LjIyNSw1LjUsMjguNQ0KCQkJYzAtOC43NjIsMy4xNDQtMTYuMzQzLDkuNDI5LTIyLjc0M0MyMS4xLTAuNDE0LDI4LjYwNC0zLjUsMzcuNDQyLTMuNXogTTEyLjcsMTkuODcyYy0wLjk1MiwyLjYyOC0xLjQyOSw1LjUwNS0xLjQyOSw4LjYyOQ0KCQkJYzAsNy4wODYsMi41OSwxMy4yMiw3Ljc3LDE4LjRjNS4yMTksNS4xNDQsMTEuMzkxLDcuNzE1LDE4LjUxNCw3LjcxNWM3LjIwMSwwLDEzLjQwOS0yLjYwOCwxOC42My03LjgyOQ0KCQkJYzEuODY3LTEuNzksMy4zMzItMy42NTcsNC4zOTgtNS42MDJsLTEyLjA1Ni01LjM3MWMtMC40MjEsMi4wMi0xLjQzOSwzLjY2Ny0zLjA1Nyw0Ljk0MmMtMS42MjIsMS4yNzYtMy41MzUsMi4wMTEtNS43NDQsMi4yDQoJCQl2NC45MTVoLTMuNzE0di00LjkxNWMtMy41NDMtMC4wMzYtNi43ODItMS4zMTItOS43MTQtMy44MjdsNC40LTQuNDU3YzIuMDk0LDEuOTQyLDQuNDc2LDIuOTEzLDcuMTQzLDIuOTEzDQoJCQljMS4xMDQsMCwyLjA0OC0wLjI0NiwyLjgzLTAuNzQzYzAuNzgtMC40OTQsMS4xNzItMS4zMTIsMS4xNzItMi40NTdjMC0wLjgwMS0wLjI4Ny0xLjQ0OC0wLjg1OC0xLjk0M2wtMy4wODUtMS4zMTVsLTMuNzcxLTEuNzE1DQoJCQlsLTUuMDg2LTIuMjI5TDEyLjcsMTkuODcyeiBNMzcuNTU3LDIuMjE0Yy03LjI3NiwwLTEzLjQyOCwyLjU3MS0xOC40NTcsNy43MTRjLTEuMjU4LDEuMjU4LTIuNDM5LDIuNjg2LTMuNTQzLDQuMjg3TDI3Ljc4NiwxOS43DQoJCQljMC41MzMtMS42NzYsMS41NDItMy4wMTksMy4wMjktNC4wMjhjMS40ODQtMS4wMDksMy4yMTgtMS41NzEsNS4yLTEuNjg2VjkuMDcxaDMuNzE1djQuOTE1YzIuOTM0LDAuMTUzLDUuNiwxLjE0Myw4LDIuOTcxDQoJCQlsLTQuMTcyLDQuMjg2Yy0xLjc5My0xLjI1Ny0zLjYxOS0xLjg4NS01LjQ4Ni0xLjg4NWMtMC45OTEsMC0xLjg3NiwwLjE5MS0yLjY1NiwwLjU3MWMtMC43ODEsMC4zODEtMS4xNzIsMS4wMjktMS4xNzIsMS45NDMNCgkJCWMwLDAuMjY3LDAuMDk1LDAuNTMzLDAuMjg1LDAuOGw0LjA1NywxLjgzbDIuOCwxLjI1N2w1LjE0NCwyLjI4NWwxNi4zOTcsNy4zMTRjMC41MzUtMi4yNDgsMC44MDEtNC41MzMsMC44MDEtNi44NTcNCgkJCWMwLTcuMzUzLTIuNTUyLTEzLjU0My03LjY1Ni0xOC41NzNDNTEuMDA1LDQuNzg1LDQ0LjgzMSwyLjIxNCwzNy41NTcsMi4yMTR6Ii8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+DQo=" class="img-fluid" style="width:4.0%"></p>
</div>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Hasta el momento hemos visto cómo efectuar estimaciones paramétricas y no paramétricas de la función de supervivencia y de la función de riesgo, que permiten describir la evolución de la “supervivencia” de una población. También hemos visto cómo comparar curvas de supervivencia, al estratificar por las distintas categorías de una variable categórica.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El análisis de supervivencia dispone también de <u>modelos de regresión</u>, que permiten identificar y evaluar la relación entre un conjunto de variables explicativas y el tiempo de supervivencia (variable respuesta), por lo que se la considera parte de los modelos lineales generalizados. A continuación, presentaremos uno de los modelos más usados en salud: el modelo de <strong>regresión de Cox</strong>, llamado así en honor a su creador (Cox, 1972).</p>
<p>La regresión de Cox, también llamada <em>modelo de riesgos proporcionales</em> (proportional hazards model) es una técnica muy difundida. Está indicado su uso cuando la variable dependiente esté relacionada con la <u>supervivencia de un grupo de sujetos</u> o, en general, con el <u>tiempo que trascurre hasta que se produce en ellos un suceso o evento</u>. Como ya dijimos, el evento de interés no tiene por qué ser la muerte, puede ser otro tipo de suceso, por ejemplo, el fallo de una prótesis, la incidencia de una enfermedad o la ocurrencia de una complicación en quien ya tiene una patología de base. Se usa para valorar simultáneamente el efecto independiente de una serie de variables explicativas o factores pronósticos sobre esta supervivencia (es decir, sobre la tasa de mortalidad) o sobre la tasa de ocurrencia de otro fenómeno que vaya ocurriendo tras un periodo de tiempo variable en cada sujeto. Como en cualquier modelo de regresión, las variables explicativas pueden ser tanto cuantitativas como categóricas.</p>
<p>La <strong>regresión de Cox</strong> es la extensión multivariada del análisis de supervivencia para evaluar de manera general variables dependientes del tipo “tiempo hasta un suceso o evento” y usa modelos de regresión, próximos al modelo de regresión logística. Es una técnica que permite identificar y evaluar la relación entre un conjunto de variables explicativas y la tasa de ocurrencia del suceso de interés.</p>
<p>La mayor utilidad del modelo de regresión de Cox radica en que permite <em>predecir las probabilidades de supervivencia</em> (o, en general de permanencia libre del evento) para un determinado sujeto a partir del patrón de valores que presenten sus variables pronósticas.</p>
<p>Al igual que en la regresión logística, en la regresión de Cox también es necesaria una función matemática que transforme el desenlace y permita entender la relación entre las variables por medio de un modelo similar al de la línea recta. Y en esto nos concentraremos a continuación.</p>
</section>
<section id="modelo-de-cox" class="level2">
<h2 class="anchored" data-anchor-id="modelo-de-cox">Modelo de Cox</h2>
<p>El modelo de Cox es un modelo semi-paramétrico que postula que:</p>
<p><span class="math display">\[h(t,x) = h_o(t) exp (x_1\beta_1+x_2\beta_2+\dots+x_n\beta_n)\]</span></p>
<p><span class="math inline">\(h (t,x)\)</span> : representa el riesgo de morir al tiempo t de un sujeto que tiene un patrón determinado de las variables x.</p>
<p><span class="math inline">\(h_0(t)\)</span>: representa el riesgo basal dependiente del t.</p>
<p>En este caso, como podemos ver, la función que es “transformada” es la función denominada <strong>Hazard</strong>, que puede simplificarse en términos prácticos como una <u>medida del riesgo instantáneo de ocurrencia de dicho evento</u>.</p>
<p>Como podemos ver, este modelo asume un presupuesto importante: las covariables tienen un efecto multiplicativo sobre la función de riesgo. ¿Qué significa esto? Esto significa que la razón entre el riesgo de ocurrencia del evento para dos individuos: individuo i e individuo j, por ejemplo, con covariables:</p>
<p><span class="math inline">\(xi= (xi_1, xi_2, xi_3,\dots,xi_n)\)</span> (es el conjunto de covariables del individuo i) <span class="math inline">\(xj= (xj_1, xj_2, xj_3,\dots,xj_n)\)</span> (es el conjunto de covariables del individuo j) será: <span class="math display">\[\frac {hi(t/xi)} {hj(t/xj)}= \frac{ho(t)exp(xi_1\beta_1+xi_2\beta_2+\dots xi_n \beta_n)}{ho(t)exp(xj_1\beta_1+xj_2 \beta_2+\dots xj_n \beta_n)}\]</span> Entonces:</p>
<p><span class="math display">\[\frac {hi(t/xi)} {hj(t/xj)}= \frac{\cancel{ho(t)} exp(xi_1\beta_1+xi_2\beta_2+\dots xi_n \beta_n)}{\cancel{ho(t)}exp(xj_1\beta_1+xj_2 \beta_2+\dots xj_n \beta_n)}\]</span></p>
<p>O sea que este cociente de riesgos, como podemos ver, es independiente del tiempo. Por este motivo, el modelo de Cox se lo conoce también como <strong>Modelo de Riesgos Proporcionales</strong>. Es un modelo semi-paramétrico, pues no asume ninguna distribución para la función de riesgo basal <span class="math inline">\(ho(t)\)</span>, la única asunción es, como ya dijimos antes, que las covariables tienen un efecto multiplicativo sobre la función de riesgo, y esto constituye la parte paramétrica del modelo.</p>
<p>En la regresión de Cox, por lo tanto, el efecto de las variables independientes se presenta como un <strong>Hazard Relativo (HR)</strong>, y expresa la magnitud en la que una variable aumenta o disminuye el riesgo de ocurrencia de un desenlace en el tiempo.</p>
<p>Como en todo modelo, tendremos que estimar los coeficientes (<span class="math inline">\(\beta\)</span>) y aprender a interpretarlos. A continuación aprenderemos a construir un modelo de Cox, fijaremos criterios para seleccionar el mejor modelo, evaluaremos el ajuste de dicho modelo y veremos algo de análisis de residuos. Allá vamos!</p>
<section id="estimación-e-interpretación-de-los-coeficientes-del-modelo-de-cox" class="level3">
<h3 class="anchored" data-anchor-id="estimación-e-interpretación-de-los-coeficientes-del-modelo-de-cox">Estimación e interpretación de los coeficientes del modelo de Cox</h3>
<p>Los coeficientes del modelo de Cox son estimados por el método de verosimilitud parcial, pero su desarrollo lo omitiremos, dado que los paquetes estadísticos, los calcularán por nosotros. Para comprender su interpretación, consideraremos el modelo más simple, con una única covariable:</p>
<p><span class="math display">\[h(t,x)= ho(t) e^{\beta x} \]</span> Si se calcula el cociente entre la tasa de riesgo instantáneo para una variable que toma los valores x=0 y x=1: <span class="math display">\[HR= \frac{e^{(\beta*1)}}{e^{(\beta*0)}}= e^\beta\]</span></p>
<p>¿Cómo interpretamos esto? Sé que ya todos tienen mucha experiencia en interpretar correctamente expresiones de este tipo (notarán ciertas similitudes con la regresión logística), pero nunca está de más reforzar.</p>
<ul>
<li><p>Si la variable es <em>dicotómica</em>, por ejemplo consideremos <em>sexo</em>, donde x=1 corresponde a masculino y x= 0 a femenino, diremos que los varones ven incrementado su riesgo en <span class="math inline">\(e\beta\)</span> respecto de las mujeres.</p></li>
<li><p>Si la variable fuera <em>continua</em>, como por ejemplo la <em>edad</em>, diremos que un incremento de un año en la edad, aumenta el riesgo en <span class="math inline">\(e\beta\)</span>. Si calculamos el cambio en <strong>h</strong> para <strong>n</strong> variables explicativas, y observamos el coeficiente para cuando cada <strong>xi</strong> se incrementa en una unidad, manteniendo constante al resto, observaremos algo similar.</p></li>
</ul>
<p>Si aplicamos <strong>ln</strong> a la expresión del HR, tendremos que: <span class="math display">\[lnHR= \beta\]</span></p>
<p>Como acabamos de ver, la interpretación del modelo de Cox no se hace directamente a través de su coeficiente estimado <span class="math inline">\((\beta)\)</span> sino del exponencial del coeficiente estimado, <span class="math inline">\(exp(\beta)\)</span>.</p>
<p>Para variables dicotómicas <span class="math inline">\(exp(\beta)\)</span> es un estimador de la razón de riesgos (Hazard Ratio) y se interpretará en forma análoga al RR: valores mayores que 1 indican sobreriesgo para el grupo “expuesto”, valores menores a 1 indican factor de protección. Para variables continuas, su interpretación es más difícil ya que no es estrictamente un RR, pero lo podemos pensar como algo similar a un RR para un incremento de la variable continua. Para comprender mejor lo que hemos visto hasta aquí y lo que seguiremos viendo, vamos a recurrir a un ejemplo.</p>
</section>
</section>
<section id="cómo-construir-un-modelo-de-cox-trabajemos-con-un-ejemplo" class="level2">
<h2 class="anchored" data-anchor-id="cómo-construir-un-modelo-de-cox-trabajemos-con-un-ejemplo">¿Cómo construir un Modelo de Cox? Trabajemos con un ejemplo</h2>
<p>Retomaremos el ejemplo sobre trasplante de médula ósea (TMO), que vimos cuando abordamos la estimación de Kaplan Meier. Recordemos que los datos del archivo <strong>tmo.txt</strong> provienen de esa cohorte de 96 pacientes sometidos a trasplante de médula ósea. Las covariables registradas para cada paciente se describen en la siguiente tabla:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Descripción</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>identificador del paciente</td>
</tr>
<tr class="even">
<td>sexo</td>
<td>M= masculino, F = femenino</td>
</tr>
<tr class="odd">
<td>edad</td>
<td>Edad al momento del trasplante (años)</td>
</tr>
<tr class="even">
<td>status</td>
<td>0 = censura, 1 = óbito</td>
</tr>
<tr class="odd">
<td>tiempo</td>
<td>tiempo hasta fecha de óbito o censura</td>
</tr>
<tr class="even">
<td>deag</td>
<td>Enfermedad injerto-huésped aguda: no,si</td>
</tr>
<tr class="odd">
<td>decr</td>
<td>Enfermedad injerto-huésped crónica: no,si</td>
</tr>
<tr class="even">
<td>fase</td>
<td>Aguda, crónica, cb: crisis blástica</td>
</tr>
</tbody>
</table>
<p>Comenzaremos leyendo el archivo (recordar activar los paquetes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tmo <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"tmo.txt"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>tmo <span class="ot">&lt;-</span> tmo <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">deag =</span> <span class="fu">factor</span>(deag),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">decr =</span> <span class="fu">factor</span>(decr),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fase =</span> <span class="fu">factor</span>(fase))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En general, no se realiza la regresión de Cox con cada una de las variables para decidir cuál incluir en el modelo (puede hacerse para ver el cambio de los coeficientes), sino que <em>esta decisión se toma en base a las curvas de KM</em>, considerando las variables en las que se observan diferencias. Como el modelo de Cox, en general se usa con fines predictivos, pueden ser incluidas otras variables que clínicamente se consideren relevantes.</p>
<p>Vamos a considerar un modelo inicial que incluya todas las variables (<strong>m1</strong>) y luego usaremos un procedimiento “hacia atrás” manual. El modelo semiparamétrico de riesgo proporcionales de Cox es realizado con la función <code>coxph()</code> del paquete <strong>“survival”</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span>  fase <span class="sc">+</span> decr <span class="sc">+</span> deag <span class="sc">+</span> sexo <span class="sc">+</span> edad, <span class="at">data =</span> tmo)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag + sexo + 
    edad, data = tmo)

  n= 96, number of events= 49 

                 coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
fasecb       0.344438  1.411197  0.542408  0.635 0.525417    
fasecrónica -0.593973  0.552129  0.371427 -1.599 0.109784    
decrsi      -1.061750  0.345850  0.338452 -3.137 0.001706 ** 
deagsi       1.190381  3.288332  0.327485  3.635 0.000278 ***
sexoM        0.271984  1.312567  0.332115  0.819 0.412816    
edad        -0.005019  0.994993  0.014912 -0.337 0.736415    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4112     0.7086    0.4874    4.0859
fasecrónica    0.5521     1.8112    0.2666    1.1434
decrsi         0.3459     2.8914    0.1782    0.6714
deagsi         3.2883     0.3041    1.7307    6.2479
sexoM          1.3126     0.7619    0.6846    2.5166
edad           0.9950     1.0050    0.9663    1.0245

Concordance= 0.768  (se = 0.03 )
Likelihood ratio test= 40.67  on 6 df,   p=3e-07
Wald test            = 38.46  on 6 df,   p=9e-07
Score (logrank) test = 47.62  on 6 df,   p=1e-08</code></pre>
</div>
</div>
<ul>
<li><p>La columna “coef” indica los valores de <span class="math inline">\(\beta\)</span> .</p></li>
<li><p>La columna “exp (coef)” indica los valores de HR.</p></li>
<li><p>La columna “se (coef)”: desvío estandard de los coeficientes</p></li>
<li><p>Z y Pr (&lt;|Z|): estadístico del Test de Wald y su p valor.</p></li>
<li><p>lower.95 y upper.95: IC para los HR.</p></li>
</ul>
<p>En la parte inferior, destacamos el <em>LR test</em> del modelo.</p>
<p>Además de lo señalado, se agregan el valor de <em>Concordancia</em> así como los <em>estadísticos de prueba</em>, <em>grados de libertad</em> y <em>p-valores</em> de las pruebas de hipótesis de Razón de Verosimilitud, Prueba de Wald y Prueba de Puntajes (score test).</p>
<p>Repasemos:</p>
<ul>
<li><p>El <strong>test de Wald</strong> : Testea solo un parámetro, por ejemplo la <span class="math inline">\(Ho: \beta_3=0\)</span>. El test estadístico es <span class="math inline">\(Z=\frac{\beta}{EE\beta}\)</span> que sigue una distribución aproximadamente N(0,1). LR y Z son aproximadamente iguales en grandes muestras, pero pueden diferir en muestras pequeñas.</p></li>
<li><p>La <strong>Deviance</strong> puede ser utilizada tanto para obtener una estadística global de ajuste del modelo, como para comparar modelos. Recordemos que: <span class="math inline">\(D= 2 (log\ Likelihood\ modelo- log\ Likelihood\ modelo\ nulo)\)</span> donde el Modelo nulo es un modelo teórico sin covariables.</p></li>
</ul>
<p>Podemos calcular el <strong>Criterio de Información de Akaike (AIC)</strong> y también el <strong>Criterio de Información Bayesiano (BIC)</strong>. El AIC sirve para comparar la plausibilidad relativa de un conjunto de modelos. Es decir, dado un conjunto de modelos construidos con los mismos datos, el AIC los ordena según su verosimilitud dados los datos con que se construyen. Este criterio tiene en cuenta tanto el ajuste del modelo como su complejidad de acuerdo a la fórmula: <span class="math inline">\(-2*log(-Likelihood) + k*npar\)</span> donde el primer término mide el ajuste (es la deviance) y el segundo la complejidad (npar es el número de parámetros y k = 2).</p>
<p>AIC mide lo lejos que está el modelo de la realidad (de un ‘modelo perfecto’), por lo que <strong>cuanto menor es el valor, más plausible es el modelo</strong>. Existen otros criterios parecidos como el BIC (en BIC k = log(n)).</p>
<p>AIC no equivale a significación; de hecho este criterio se plantea dentro de una concepción de la estadística distinta –y alternativa– a la fundamentada en testado de hipótesis. El comando es simplemente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span> (m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 378.1393</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 389.4903</code></pre>
</div>
</div>
<p>El <strong>Likelihood</strong> nos da una evaluación cuantitativa de la compatibilidad de los datos con determinado valor del parámetro. <span class="math display">\[Likelihood\ Ratio= \frac {Likelihood\ del\ modelo}{Máximo\ de\ Likelihood}\]</span></p>
<ul>
<li><p>El Likelihood Ratio da una medida más conveniente del soporte de los datos para determinado valor de probabilidades que el likelihood, ya que relativiza los valores de los likelihood al valor del máximo likelihood.</p></li>
<li><p>Cuanto más cerca de 1 está un Likelihood ratio significa que ese valor de p está más “sustentado” por los datos.</p></li>
<li><p>El <u>LR test compara dos modelos anidados</u>: modelo mayor vs.&nbsp;modelo reducido. La H0 plantea que algunos parámetros en el modelo completo son igual a 0. Este LR tiene aproximadamente una distribución chi-cuadrado bajo la hipótesis nula.</p></li>
</ul>
<section id="analicemos-nuestro-modelo" class="level3">
<h3 class="anchored" data-anchor-id="analicemos-nuestro-modelo">Analicemos nuestro modelo</h3>
<p>Solamente los coeficientes que acompañan a las variables <em>deag</em> y <em>decr</em> resultaron significativos según el test de Wald. Esto es lo mismo que observamos en las curvas de KM.</p>
<p>Respecto de la variable fase, que tiene 3 categorías, observemos que fue transformada en una variable dummy: el modelo ha tomado como categoría de referencia “aguda” y los valores de HR son en referencia a esta categoría: “crisis blástica” respecto a “aguda” y “crónica” respecto a “aguda”.</p>
<p>La columna “Coefficient” representa los valores de <span class="math inline">\(\beta\)</span> estimados por verosimilitud parcial. Valores positivos de <span class="math inline">\(\beta\)</span> indican variables que contribuyen a un incremento de riesgo, en tanto que valores negativos de <span class="math inline">\(\beta\)</span> indican variables que contribuyen a reducir el riesgo. Si miramos los HR, vemos que <em>decr</em> resultó un factor protector importante.</p>
<p>Probaremos un <strong>m2</strong> con 4 variables ¿Cuál saco del modelo: edad, sexo o fase? Probemos distintos modelos:</p>
<ul>
<li><strong>m2</strong>: fase + decr + deag + edad (sacando <em>sexo</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase <span class="sc">+</span> decr <span class="sc">+</span> deag <span class="sc">+</span> edad, <span class="at">data =</span> tmo)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag + edad, 
    data = tmo)

  n= 96, number of events= 49 

                coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.34930   1.41808  0.54010  0.647 0.517801    
fasecrónica -0.66770   0.51289  0.35813 -1.864 0.062262 .  
decrsi      -1.04100   0.35310  0.33283 -3.128 0.001762 ** 
deagsi       1.15232   3.16554  0.32110  3.589 0.000332 ***
edad        -0.00272   0.99728  0.01452 -0.187 0.851418    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4181     0.7052    0.4920     4.087
fasecrónica    0.5129     1.9498    0.2542     1.035
decrsi         0.3531     2.8321    0.1839     0.678
deagsi         3.1655     0.3159    1.6870     5.940
edad           0.9973     1.0027    0.9693     1.026

Concordance= 0.758  (se = 0.031 )
Likelihood ratio test= 39.98  on 5 df,   p=2e-07
Wald test            = 38.28  on 5 df,   p=3e-07
Score (logrank) test = 47.16  on 5 df,   p=5e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span> (m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 376.825</code></pre>
</div>
</div>
<ul>
<li><strong>m3</strong>: fase + decr + deag +sexo (sacando <em>edad</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase <span class="sc">+</span> decr <span class="sc">+</span> deag <span class="sc">+</span> sexo, <span class="at">data =</span> tmo)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag + sexo, 
    data = tmo)

  n= 96, number of events= 49 

               coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.3378    1.4019   0.5429  0.622 0.533779    
fasecrónica -0.5715    0.5647   0.3647 -1.567 0.117090    
decrsi      -1.0940    0.3349   0.3246 -3.370 0.000750 ***
deagsi       1.2075    3.3451   0.3240  3.726 0.000194 ***
sexoM        0.2509    1.2852   0.3251  0.772 0.440233    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4019     0.7133    0.4837    4.0631
fasecrónica    0.5647     1.7709    0.2763    1.1540
decrsi         0.3349     2.9863    0.1772    0.6326
deagsi         3.3451     0.2989    1.7725    6.3128
sexoM          1.2852     0.7781    0.6796    2.4306

Concordance= 0.762  (se = 0.03 )
Likelihood ratio test= 40.56  on 5 df,   p=1e-07
Wald test            = 38.19  on 5 df,   p=3e-07
Score (logrank) test = 47.46  on 5 df,   p=5e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 376.2529</code></pre>
</div>
</div>
<ul>
<li><strong>m4</strong>: sexo + decr + deag + edad (sacando <em>fase</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> decr <span class="sc">+</span> deag <span class="sc">+</span> sexo <span class="sc">+</span> edad, <span class="at">data =</span> tmo)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag + sexo + edad, 
    data = tmo)

  n= 96, number of events= 49 

             coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    
decrsi -1.3160459  0.2681937  0.3150468 -4.177 2.95e-05 ***
deagsi  1.1988240  3.3162147  0.3084393  3.887 0.000102 ***
sexoM   0.4531812  1.5733092  0.3241990  1.398 0.162158    
edad    0.0003653  1.0003654  0.0142724  0.026 0.979578    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2682     3.7286    0.1446    0.4973
deagsi    3.3162     0.3015    1.8118    6.0700
sexoM     1.5733     0.6356    0.8334    2.9701
edad      1.0004     0.9996    0.9728    1.0287

Concordance= 0.732  (se = 0.032 )
Likelihood ratio test= 36.35  on 4 df,   p=2e-07
Wald test            = 32.6  on 4 df,   p=1e-06
Score (logrank) test = 38.43  on 4 df,   p=9e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 378.4578</code></pre>
</div>
</div>
<p>De acuerdo al criterio AIC, considerando los modelos construidos, el <strong>m3</strong> sería un mejor modelo, dado que tiene un menor AIC, pero se observa que existen términos sin significación en este modelo, según el test de Wald.</p>
<p>Ajustemos ahora un modelo con 3 variables, partiendo del <strong>m3</strong>, que recordemos era:</p>
<p><strong>m3</strong>: fase + decr + deag + sexo</p>
<p>En general, el criterio que se utiliza para “sacar” variables del modelo, es sacar aquellas cuyo <span class="math inline">\(\beta\)</span> haya resultado no significativo. En el caso de m3 serían los <span class="math inline">\(\beta\)</span> correspondientes a las variables <em>sexo</em> y <em>fase</em>.</p>
<ul>
<li><strong>m5</strong>: fase + decr + deag (sacando <em>sexo</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase <span class="sc">+</span> decr <span class="sc">+</span> deag, <span class="at">data =</span> tmo)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag, data = tmo)

  n= 96, number of events= 49 

               coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.3449    1.4119   0.5402  0.639 0.523100    
fasecrónica -0.6509    0.5216   0.3467 -1.878 0.060440 .  
decrsi      -1.0597    0.3466   0.3176 -3.336 0.000849 ***
deagsi       1.1633    3.2004   0.3160  3.681 0.000232 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4119     0.7083    0.4898    4.0698
fasecrónica    0.5216     1.9173    0.2644    1.0290
decrsi         0.3466     2.8856    0.1860    0.6458
deagsi         3.2004     0.3125    1.7227    5.9456

Concordance= 0.753  (se = 0.03 )
Likelihood ratio test= 39.95  on 4 df,   p=4e-08
Wald test            = 38.18  on 4 df,   p=1e-07
Score (logrank) test = 47.11  on 4 df,   p=1e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 374.8601</code></pre>
</div>
</div>
<ul>
<li><strong>m6</strong>: decr + deag + sexo (sacando <em>fase</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> decr <span class="sc">+</span> deag <span class="sc">+</span> sexo,  <span class="at">data =</span> tmo)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag + sexo, data = tmo)

  n= 96, number of events= 49 

          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
decrsi -1.3143    0.2687   0.3072 -4.279 1.88e-05 ***
deagsi  1.1977    3.3124   0.3051  3.925 8.66e-05 ***
sexoM   0.4555    1.5769   0.3115  1.462    0.144    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2687     3.7220    0.1472    0.4906
deagsi    3.3124     0.3019    1.8215    6.0236
sexoM     1.5769     0.6341    0.8564    2.9037

Concordance= 0.74  (se = 0.031 )
Likelihood ratio test= 36.35  on 3 df,   p=6e-08
Wald test            = 32.6  on 3 df,   p=4e-07
Score (logrank) test = 38.43  on 3 df,   p=2e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 376.4584</code></pre>
</div>
</div>
<p>El <strong>m5</strong> parece ser un mejor modelo, con un AIC menor (374,8601).</p>
<p>Ensayemos ahora un modelo con 2 variables, a partir entonces de <strong>m5</strong> (fase + decr + deag). Saco <em>fase</em>, dado que su coeficiente resultó no significativo.</p>
<ul>
<li><strong>m7</strong>: deag + decr</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m7 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> decr <span class="sc">+</span> deag, <span class="at">data =</span> tmo)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag, data = tmo)

  n= 96, number of events= 49 

          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
decrsi -1.2532    0.2856   0.3038 -4.125 3.71e-05 ***
deagsi  1.1001    3.0045   0.2959  3.717 0.000201 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2856     3.5015    0.1574     0.518
deagsi    3.0045     0.3328    1.6822     5.366

Concordance= 0.739  (se = 0.03 )
Likelihood ratio test= 34.13  on 2 df,   p=4e-08
Wald test            = 32.9  on 2 df,   p=7e-08
Score (logrank) test = 37.62  on 2 df,   p=7e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 376.6813</code></pre>
</div>
</div>
<p>Ahora todas las variables tienen significación y, si bien no ha habido mejora en el AIC, según los valores del test de Wald, parece un mejor modelo. No obstante, podemos comparar los modelos “candidatos”.</p>
<p>La comparación entre los modelos se realiza con la función <code>anova()</code>, que realiza la prueba de Razón de Verosimilitud entre dos modelos. Los argumentos de la función son los dos modelos ajustados a comparar. La salida de la función es una tabla en donde muestra para los dos modelos el log-verosimilitud, el estadísticos Chisq, los grados de libertad Df y el p-valor P(&gt;|Chi|) de la prueba.</p>
<p>Ahora, seleccionamos los dos modelos a comparar en nuestro caso: <strong>m5</strong> y <strong>m7</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5, m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table
 Cox model: response is  Surv(tiempo, status)
 Model 1: ~ fase + decr + deag
 Model 2: ~ decr + deag
   loglik  Chisq Df Pr(&gt;|Chi|)  
1 -183.43                       
2 -186.34 5.8212  2    0.05444 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Recordemos que los modelos deben ser anidados para poder hacer ANOVA. En este caso, lo que hace es comparar los log de Likelihood de ambos modelos. Esa diferencia se distribuye como un Chi cuadrado. El valor de p se encuentra en el límite de significación (considerando 0,05). Si somos estrictos, el valor de p indica que no hay diferencia entre ambos modelos, por lo tanto nos quedaríamos con el de menos variables, de acuerdo al principio de parsimonia.</p>
<p>En nuestro caso, podemos decidir quedarnos con el <strong>m5</strong>, dado que la fase de la enfermedad puede resultar un elemento predictivo importante. Como se indicó anteriormente, la regresión de Cox generalmente tiene fines predictivos, así que podemos ver en la bibliografía, modelos que no siguen todas las “normas” del modelado, porque se hace importante mantener variables como edad o sexo, aún cuando no resulten significativas, a fin de contar con intervalos de predicción por sexo o grupo etario.</p>
<p>Supongamos entonces que decidimos quedarnos con el <strong>m5</strong>, aunque rompamos algunas reglas. Interpretemos ahora los parámetros del modelo:</p>
<ul>
<li><strong>m5</strong>: fase + decr + deag</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase <span class="sc">+</span> decr <span class="sc">+</span> deag, <span class="at">data =</span> tmo)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag, data = tmo)

  n= 96, number of events= 49 

               coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.3449    1.4119   0.5402  0.639 0.523100    
fasecrónica -0.6509    0.5216   0.3467 -1.878 0.060440 .  
decrsi      -1.0597    0.3466   0.3176 -3.336 0.000849 ***
deagsi       1.1633    3.2004   0.3160  3.681 0.000232 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4119     0.7083    0.4898    4.0698
fasecrónica    0.5216     1.9173    0.2644    1.0290
decrsi         0.3466     2.8856    0.1860    0.6458
deagsi         3.2004     0.3125    1.7227    5.9456

Concordance= 0.753  (se = 0.03 )
Likelihood ratio test= 39.95  on 4 df,   p=4e-08
Wald test            = 38.18  on 4 df,   p=1e-07
Score (logrank) test = 47.11  on 4 df,   p=1e-09</code></pre>
</div>
</div>
<p>Para la interpretación, nos centramos en la columna exp(coef), que corresponde a los HR. Partiendo de dichos valores, podemos concluir:</p>
<ul>
<li><p>El riesgo de muerte de los pacientes que padecen enfermedad injerto contra huésped aguda es aproximadamente el triple de aquellos que no la han padecido (HR=3.2).</p></li>
<li><p>Los pacientes que hayan padecido enfermedad injerto contra huésped crónica tienen 0,34 veces el riesgo de morir post TMO de los que no la tuvieron. Puede decirse también (y quizás quedaría mejor expresado) que tienen un 66% menos riesgo que los que no tuvieron enfermedad injerto contra huésped crónica (HR=0.34).</p></li>
<li><p>Los pacientes que reciben trasplante en la fase crónica de la enfermedad, tienen un riesgo 48% menor de morir post TMO que aquellos que son trasplantados en la fase aguda (si consideramos un p&lt; 0,1, este término tendría significación). Se observó un aumento de riesgo en los que reciben trasplante en la crisis blástica respecto de quienes lo reciben en la aguda, pero este término no resultó significativo.</p></li>
</ul>
</section>
<section id="algunas-alternativas" class="level3">
<h3 class="anchored" data-anchor-id="algunas-alternativas">Algunas alternativas</h3>
<p>Como hemos visto para modelados anteriores, podemos construir el modelo de Cox con funciones del paquete <strong>stats</strong> y del paquete <strong>performance</strong>.</p>
<p>Les recordamos que para la comparación de modelos con la función <code>compare_performance()</code> van a observar que se utiliza el indicador <strong>AIC weights</strong> en lugar del AIC. El AIC weights es un parámetro que cuantifica de manera relativa la calidad de un modelo. Refleja la probabilidad relativa de que un modelo sea el mejor entre un conjunto de modelos candidatos. Su cálculo se basa en la comparación de los valores de AIC de cada modelo considerado.</p>
<p>Por esto, <u>se interpreta de manera inversa al AIC</u>: a mayor valor de AIC weights, mayor probabilidad de que el modelo sea un mejor candidato en comparación al resto.</p>
<p>Les dejamos a continuación el proceso backwards utilizando funciones de estos paquetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Selección backwards a partir del modelo saturado</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span>  fase <span class="sc">+</span> decr <span class="sc">+</span> deag <span class="sc">+</span> sexo <span class="sc">+</span> edad, <span class="at">data =</span> tmo)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Surv(tiempo, status) ~ fase + decr + deag + sexo + edad
       Df    AIC
&lt;none&gt;    378.14
fase    2 378.46
decr    1 386.29
deag    1 389.22
sexo    1 376.82
edad    1 376.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (-) sexo</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fit_m2 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, <span class="sc">~</span>.<span class="sc">-</span>sexo)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (-) edad</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>fit_m3 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, <span class="sc">~</span>.<span class="sc">-</span>edad)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (-) fase</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>fit_m4 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, <span class="sc">~</span>.<span class="sc">-</span>fase)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag + edad, 
    data = tmo)

  n= 96, number of events= 49 

                coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.34930   1.41808  0.54010  0.647 0.517801    
fasecrónica -0.66770   0.51289  0.35813 -1.864 0.062262 .  
decrsi      -1.04100   0.35310  0.33283 -3.128 0.001762 ** 
deagsi       1.15232   3.16554  0.32110  3.589 0.000332 ***
edad        -0.00272   0.99728  0.01452 -0.187 0.851418    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4181     0.7052    0.4920     4.087
fasecrónica    0.5129     1.9498    0.2542     1.035
decrsi         0.3531     2.8321    0.1839     0.678
deagsi         3.1655     0.3159    1.6870     5.940
edad           0.9973     1.0027    0.9693     1.026

Concordance= 0.758  (se = 0.031 )
Likelihood ratio test= 39.98  on 5 df,   p=2e-07
Wald test            = 38.28  on 5 df,   p=3e-07
Score (logrank) test = 47.16  on 5 df,   p=5e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag + sexo, 
    data = tmo)

  n= 96, number of events= 49 

               coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.3378    1.4019   0.5429  0.622 0.533779    
fasecrónica -0.5715    0.5647   0.3647 -1.567 0.117090    
decrsi      -1.0940    0.3349   0.3246 -3.370 0.000750 ***
deagsi       1.2075    3.3451   0.3240  3.726 0.000194 ***
sexoM        0.2509    1.2852   0.3251  0.772 0.440233    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4019     0.7133    0.4837    4.0631
fasecrónica    0.5647     1.7709    0.2763    1.1540
decrsi         0.3349     2.9863    0.1772    0.6326
deagsi         3.3451     0.2989    1.7725    6.3128
sexoM          1.2852     0.7781    0.6796    2.4306

Concordance= 0.762  (se = 0.03 )
Likelihood ratio test= 40.56  on 5 df,   p=1e-07
Wald test            = 38.19  on 5 df,   p=3e-07
Score (logrank) test = 47.46  on 5 df,   p=5e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag + sexo + edad, 
    data = tmo)

  n= 96, number of events= 49 

             coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    
decrsi -1.3160459  0.2681937  0.3150468 -4.177 2.95e-05 ***
deagsi  1.1988240  3.3162147  0.3084393  3.887 0.000102 ***
sexoM   0.4531812  1.5733092  0.3241990  1.398 0.162158    
edad    0.0003653  1.0003654  0.0142724  0.026 0.979578    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2682     3.7286    0.1446    0.4973
deagsi    3.3162     0.3015    1.8118    6.0700
sexoM     1.5733     0.6356    0.8334    2.9701
edad      1.0004     0.9996    0.9728    1.0287

Concordance= 0.732  (se = 0.032 )
Likelihood ratio test= 36.35  on 4 df,   p=2e-07
Wald test            = 32.6  on 4 df,   p=1e-06
Score (logrank) test = 38.43  on 4 df,   p=9e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación de modelos</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(m1, fit_m2, fit_m3, fit_m4, <span class="at">metrics =</span> <span class="st">"AIC"</span>, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   | Model | AIC weights | Performance-Score
------------------------------------------------
fit_m3 | coxph |       0.404 |           100.00%
fit_m2 | coxph |       0.304 |            62.75%
m1     | coxph |       0.157 |             8.58%
fit_m4 | coxph |       0.134 |             0.00%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Selección a partir de fit_m3</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit_m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Surv(tiempo, status) ~ fase + decr + deag + sexo
       Df    AIC
&lt;none&gt;    376.25
fase    2 376.46
decr    1 386.02
deag    1 387.91
sexo    1 374.86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (-) sexo</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>fit_m5 <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_m3, <span class="sc">~</span>.<span class="sc">-</span>sexo)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (-) fase</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>fit_m6 <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_m3, <span class="sc">~</span>.<span class="sc">-</span>fase)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + decr + deag, data = tmo)

  n= 96, number of events= 49 

               coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.3449    1.4119   0.5402  0.639 0.523100    
fasecrónica -0.6509    0.5216   0.3467 -1.878 0.060440 .  
decrsi      -1.0597    0.3466   0.3176 -3.336 0.000849 ***
deagsi       1.1633    3.2004   0.3160  3.681 0.000232 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb         1.4119     0.7083    0.4898    4.0698
fasecrónica    0.5216     1.9173    0.2644    1.0290
decrsi         0.3466     2.8856    0.1860    0.6458
deagsi         3.2004     0.3125    1.7227    5.9456

Concordance= 0.753  (se = 0.03 )
Likelihood ratio test= 39.95  on 4 df,   p=4e-08
Wald test            = 38.18  on 4 df,   p=1e-07
Score (logrank) test = 47.11  on 4 df,   p=1e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag + sexo, data = tmo)

  n= 96, number of events= 49 

          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
decrsi -1.3143    0.2687   0.3072 -4.279 1.88e-05 ***
deagsi  1.1977    3.3124   0.3051  3.925 8.66e-05 ***
sexoM   0.4555    1.5769   0.3115  1.462    0.144    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2687     3.7220    0.1472    0.4906
deagsi    3.3124     0.3019    1.8215    6.0236
sexoM     1.5769     0.6341    0.8564    2.9037

Concordance= 0.74  (se = 0.031 )
Likelihood ratio test= 36.35  on 3 df,   p=6e-08
Wald test            = 32.6  on 3 df,   p=4e-07
Score (logrank) test = 38.43  on 3 df,   p=2e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparación de modelos</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_m3, fit_m5, fit_m6, <span class="at">metrics =</span> <span class="st">"AIC"</span>, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   | Model | AIC weights | Performance-Score
------------------------------------------------
fit_m5 | coxph |       0.513 |           100.00%
fit_m3 | coxph |       0.256 |             8.85%
fit_m6 | coxph |       0.231 |             0.00%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Selección a partir de fit_m5</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(fit_m5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Surv(tiempo, status) ~ fase + decr + deag
       Df    AIC
&lt;none&gt;    374.86
fase    2 376.68
decr    1 384.27
deag    1 386.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_m5 (-) fase</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>fit_m7 <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_m5, <span class="sc">~</span>.<span class="sc">-</span>fase)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_m7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ decr + deag, data = tmo)

  n= 96, number of events= 49 

          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
decrsi -1.2532    0.2856   0.3038 -4.125 3.71e-05 ***
deagsi  1.1001    3.0045   0.2959  3.717 0.000201 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
decrsi    0.2856     3.5015    0.1574     0.518
deagsi    3.0045     0.3328    1.6822     5.366

Concordance= 0.739  (se = 0.03 )
Likelihood ratio test= 34.13  on 2 df,   p=4e-08
Wald test            = 32.9  on 2 df,   p=7e-08
Score (logrank) test = 37.62  on 2 df,   p=7e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_m5, fit_m7, <span class="at">metrics =</span> <span class="st">"AIC"</span>, <span class="at">rank =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name   | Model | AIC weights | Performance-Score
------------------------------------------------
fit_m5 | coxph |       0.713 |           100.00%
fit_m7 | coxph |       0.287 |             0.00%</code></pre>
</div>
</div>
<p>Por otro lado, recordemos que R permite también hacer una <strong>selección automática de los modelos</strong>, tanto para supervivencia como para cualquier tipo de modelado. Normalmente la bibliografía no recomienda los procedimientos automáticos, pero tengamos en claro lo que ocurre en cada caso:</p>
<ul>
<li><p>“hacia atrás / adelante” (el valor por defecto): la selección comienza con el modelo completo y elimina los predictores uno a la vez, en cada paso, considerando si el criterio será mejorado agregando de nuevo una variable eliminada en un paso anterior.</p></li>
<li><p>“hacia adelante / hacia atrás”, la selección comienza con un modelo que incluye sólo una constante, y añade predictores uno a la vez, en cada paso considerando si el criterio se mejorará mediante la eliminación de una variable agregada anteriormente.</p></li>
<li><p>“atrás” y “adelante” son similares sin la reconsideración en cada paso.</p></li>
</ul>
</section>
</section>
<section id="predicción-de-la-curva-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="predicción-de-la-curva-de-supervivencia">Predicción de la curva de supervivencia</h2>
<p>Ahora, estaríamos en condiciones de obtener la función de supervivencia ajustada mediante el modelo de Cox seleccionado. La función <code>survfit()</code> del paquete <strong>survival</strong> calcula la función de supervivencia pronosticada para un modelo de riesgos proporcionales de Cox.</p>
<p>Para ello, la función de R es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(m5))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podríamos comparar esto con lo obtenido en la estimación de Kaplan Meier (ver módulo de KM, pag.4 ). Pero, siempre resulta más claro realizar la comparación en forma gráfica: graficaremos la función de supervivencia obtenida mediante el estimador de Kaplan Meier y la obtenida mediante el modelo de Cox seleccionado. Para esto, primero tendremos que crear una lista con las funciones de supervivencia requeridas para luego graficarlas utilizando la función <code>ggsurvplot_combine()</code> del paquete <strong>survminer.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>global <span class="ot">&lt;-</span> <span class="fu">Surv</span>(tmo<span class="sc">$</span>tiempo, tmo<span class="sc">$</span>status) <span class="co"># Creamos un objeto con la estimación de KM</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">modelo =</span> <span class="fu">survfit</span>(m5), <span class="co"># Creamos una lista con la función de supervivencia del modelo final seleccionado</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">global =</span> <span class="fu">survfit</span>(global <span class="sc">~</span> <span class="dv">1</span>)) <span class="co"># y la función del estimador de KM</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot_combine</span>(fit, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> tmo,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">title =</span> <span class="st">"Comparación del ajuste del modelo de Cox y el estimador de KM"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Días"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Supervivencia"</span>,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.title =</span> <span class="st">""</span>,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">"Ajuste por Cox"</span>, <span class="st">"Estimador de KM"</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Podemos observar que el modelo seleccionado, ajusta bastante bien (sobreestima al principio, subestima al final). Sin embargo, en lo que a modelado respecta, para evaluar la calidad de ajuste contamos con parámetros adicionales.</p>
</section>
<section id="calidad-de-ajuste-de-un-modelo" class="level2">
<h2 class="anchored" data-anchor-id="calidad-de-ajuste-de-un-modelo">Calidad de ajuste de un modelo</h2>
<p>Hay pocas medidas para evaluar el ajuste de un modelo de supervivencia. Una de las más simples es R2, cuya expresión es: <span class="math display">\[R^2_{LR}= 1- \bigg(\frac{Likelihood(modelo\ nulo)}{Likelihood(modelo\ ajustado)} \bigg )^ \frac{2}{n}\]</span></p>
<p>Su interpretación es similar a la del <span class="math inline">\(R^2\)</span> de los otros modelos lineales:</p>
<p><span class="math inline">\(R^2\)</span> puede ser interpretado como el poder explicativo de las covariables en el tiempo de ocurrencia del evento en estudio.</p>
<p><span class="math inline">\(R^2\)</span> tiene valores bajos en los análisis de supervivencia (alrededor de 30% de poder explicativo), por lo que muchos autores no lo consideran apropiado. De hecho, en las salidas de R de los modelos, observamos que no lo muestra actualmente, siendo que antes sí lo ofrecía, atendiendo a estas y otras cuestiones teóricas. En su lugar, ofrece el valor de <strong>concordancia</strong>. Profundizaremos un poco sobre este concepto, ya que no lo hemos visto en otros modelos.</p>
<p>El uso de la estadística de <strong>concordancia</strong> para los modelos de Cox fue popularizado por Harrel <span class="citation" data-cites="harrell1996">(<a href="#ref-harrell1996" role="doc-biblioref">Harrell, Lee, and Mark 1996</a>)</span>, y ahora es la medida más usada como bondad de ajuste en los modelos de supervivencia. Una ventaja de la estadística es que está bien definida, no solo para los modelos de supervivencia, sino también para la regresión lineal logística y ordinaria.</p>
<p>En general, si <strong>yi</strong> y <strong>xi</strong> son los valores observados y predichos por el modelo, respectivamente, la concordancia se define como <span class="math inline">\(P(x_i &gt; x_j|y_i&gt; y_j)\)</span>, la probabilidad de que la predicción <strong>x</strong> vaya en la misma dirección que los datos reales <strong>y</strong>. Un par de las observaciones <strong>i, j</strong> se consideran concordantes si la predicción y los datos van en la misma dirección. <strong>La concordancia es la fracción de pares concordantes</strong>.</p>
<p>En general, se acepta la siguiente escala:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Concordancia (c)</th>
<th style="text-align: center;">Poder discriminatorio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.3 &lt; c &lt; 0.4</td>
<td style="text-align: center;">Bajo</td>
</tr>
<tr class="even">
<td style="text-align: center;">c = 0.5</td>
<td style="text-align: center;">Por azar</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.6 &lt; c &lt; 0.7</td>
<td style="text-align: center;">Común</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.7 &lt; c &lt; 0.8</td>
<td style="text-align: center;">Muy bueno</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.8 &lt; c &lt; 0.9</td>
<td style="text-align: center;">Excelente</td>
</tr>
</tbody>
</table>
<p>Si observamos, el valor de concordancia para el modelo <strong>m5</strong> = 0.753, lo que indica muy buena concordancia entre lo observado y lo predicho por el modelo.</p>
</section>
<section id="análisis-de-residuos" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-residuos">Análisis de residuos</h2>
<p>Como ustedes recordarán, se denomina residuo a la diferencia entre el valor observado y el valor estimado por la ecuación de regresión, es decir a lo que la ecuación de regresión deja sin explicar para cada observación.</p>
<p>La definición de residuo en el análisis de supervivencia no es tan simple y directa como esta definición, dado, que, por ejemplo, un residuo obtenido como respuesta observada menos esperada, no tiene en consideración el tiempo observado de un individuo censurado.</p>
<p>En el análisis de supervivencia, se describen distintos tipos de residuos que sirven para evaluar distintos aspectos del modelo:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 63%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Evaluación</th>
<th style="text-align: left;">Tipo de residuo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Para verificar riesgos proporcionales</td>
<td style="text-align: left;">Residuos de Schoenfeld</td>
</tr>
<tr class="even">
<td>Para evaluar si es adecuado incluir las variables en forma lineal en el modelo</td>
<td style="text-align: left;">Residuos Martingale</td>
</tr>
<tr class="odd">
<td>Para detectar residuos grandes (outliers)</td>
<td style="text-align: left;">Residuos de Deviance</td>
</tr>
<tr class="even">
<td>Para evaluar el impacto que tiene cada observación en el modelo, tanto en forma global como por variable</td>
<td style="text-align: left;">Residuos Score</td>
</tr>
</tbody>
</table>
<p><strong>Y ahora algo más</strong>: para covariables con pocas categorías, las curvas de KM estratificadas dan una idea si se cumple el presupuesto de riesgos proporcionales de Cox. Curvas que son razonablemente paralelas a lo largo del tiempo indican proporcionalidad de riesgo entre las categorías y, por el contrario, el entrecruzamiento o una variación en las distancias entre las categorías, podría indicar falta de proporcionalidad.</p>
<p>Si tienen presentes las curvas de KM que construimos para este ejemplo, en todas las curvas que se muestran, parece razonable suponer que se cumple el supuesto de proporcionalidad, aún en el caso de la variable sexo, dado que ambas categorías están prácticamente superpuestas, separándose recién al final, cuando quedan pocas observaciones.</p>
<p>A continuación, abordaremos el análisis de residuos, al menos de algunos de ellos. Para el desarrollo de gráficos seguiremos explorando el paquete <strong>survminer</strong>. Les aclaramos, además, que no utilizaremos la función <code>check_model()</code> del paquete <strong>performance</strong> para esta ocasión dado que no permite aún el análisis de residuos para modelos de Cox.</p>
<section id="residuos-de-schoenfeld" class="level3">
<h3 class="anchored" data-anchor-id="residuos-de-schoenfeld">Residuos de Schoenfeld</h3>
<p>Podríamos preguntarnos si el efecto de cada covariable será el mismo a medida que transcurra el tiempo, porque si no es así, se trataría de covariables tiempo dependientes. Para responder esta cuestión, se calculan los <u>Residuos de Schoenfeld</u>.</p>
<p>Se genera un residuo para cada variable y para cada paciente, es decir que si tenemos un modelo de Cox con tres factores pronóstico se calcularán 3 residuos de Schoenfeld por paciente. Estos residuos valen cero para las observaciones incompletas. Es posible modificar estos residuos con el fin de que no valgan cero para las observaciones incompletas, obteniéndose entonces los denominados residuos Schoenfeld corregidos o escalados.</p>
<p>En R, la función <code>cox.zph()</code> realiza la prueba de hipótesis de correlación para los residuos de Schoenfeld de cada covariable con alguna transformación del tiempo, los argumentos de la función son:</p>
<ul>
<li><p><em>fit</em>: Un objeto coxph resultado de un ajuste del modelo de regresión de Cox.</p></li>
<li><p><em>transform</em>: Tipo de transformación del tiempo, posibles valores son “km”, “rank”, “identity” o una función.</p></li>
<li><p><em>global</em>: una prueba chi cuadrado global.</p></li>
</ul>
<p>La salida de la función es una tabla en donde para cada covariable calcula el coeficiente rho, el estadístico de prueba chisq y su respectivo p-valor, además incluye una prueba global. Por ejemplo, para el <strong>m5</strong> o para <strong>m7</strong>, el supuesto de riesgos proporcionales puede ser verificado mediante el contraste de hipótesis generado mediante el comando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(m5, <span class="at">transform =</span> <span class="st">"km"</span>, <span class="at">global =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        chisq df       p
fase    9.308  2 0.00952
decr    7.834  1 0.00513
deag    0.279  1 0.59742
GLOBAL 18.546  4 0.00097</code></pre>
</div>
</div>
<p><strong>¿Qué significa esta salida?</strong></p>
<p>La H0 que se testea es que la correlación lineal entre el residuo de Schoenfeld y el tiempo de supervivencia es cero.</p>
<p>Esto es equivalente a probar H0: pendiente igual a cero o H0: logHR es constante en el tiempo.</p>
<p>De lo expuesto se concluye que existe evidencia significativa al 5% de que se viole el supuesto de riesgos proporcionales, desde el punto de vista global, y para la covariable “<em>decr</em>”.</p>
<p>La validación del supuesto de riesgos proporcionales puede realizarse también en forma gráfica con la función <code>ggcoxdiagnostics()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(m5, </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"schoenfeld"</span>, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">"Residuos de Schonfeld"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"Residuos"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">"Tiempo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La interpretación se facilita con el agregado de una línea de tendencia “lowess”, de esta forma, cuando esta línea se desvía de una línea constante, se sospecha una estructura tiempo dependiente en el efecto de la covariable.</p>
<p>Los gráficos confirman lo que hallamos con el test: los residuos tienen un patrón o estructura con el tiempo. En el caso de la variable <em>decr</em>, parece visualizarse una relación lineal.</p>
<p>Frente al problema de No proporcionalidad, se deberá evaluar:</p>
<ul>
<li><p>Magnitud</p></li>
<li><p>Puntos influyentes</p></li>
</ul>
<p><em>¿Cuáles son las posibles soluciones?</em> Estratificar por covariable dependiente del tiempo, dividir el eje del tiempo o utilizar otro tipo de modelo.</p>
<p>Continuaremos analizando los residuos de este modelo y retomaremos el tema cuando lleguemos a modelos estratificados.</p>
</section>
<section id="residuos-martingale" class="level3">
<h3 class="anchored" data-anchor-id="residuos-martingale">Residuos Martingale</h3>
<p>El residuo martingale de un sujeto es simplemente la diferencia entre el número de acontecimientos observados y el número de acontecimientos esperados según el modelo.</p>
<p>Se grafica: <strong>Mi</strong> vs <strong>índice de individuo</strong>, permitiendo revelar sujetos mal ajustados por el modelo. Nuevamente nos será de utilidad la función <code>ggcoxdiagnostics()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(m5, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"martingale"</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">"Residuos de Martingale"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"Residuos"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">xlab =</span> <span class="st">"Índice"</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este gráfico sirve para evidenciar posibles valores aberrantes: individuos que demoraron mucho o demasiado poco en tener el evento (como los que señalan las flechas). Se espera que se distribuyan en torno a la línea punteada del 0, sin ningún patrón remanente. Valores de <strong>Mi</strong> mayores que 0, indica que el numero de eventos observados es menor que los estimados por el modelo y viceversa.</p>
</section>
</section>
<section id="modelo-de-cox-estratificado" class="level2">
<h2 class="anchored" data-anchor-id="modelo-de-cox-estratificado">Modelo de Cox estratificado</h2>
<p>En algunas situaciones no podemos asumir que el riesgo basal <span class="math inline">\(h_o(t)\)</span> sea el mismo para todos los individuos del estudio. Esto podría ser por la característica propia de la variable (como la edad) o porque el diseño sea estratificado a priori (por ej. estadíos de una enfermedad). En estos casos, los distintos <span class="math inline">\(h_o(t)\)</span> definen los distintos estratos.</p>
<p>Los coeficientes <span class="math inline">\(\beta\)</span> también se estiman por el método de verosimilitud parcial, pero los individuos en riesgo que participan de la estimación son sólo los del estrato.</p>
<p>El modelo de Cox estratificado constituye una de las maneras de corregir el modelo de Cox cuando no se cumple el supuesto de riesgos proporcionales para alguna de las covariables. En este caso suele correrse el modelo estratificando por la covariable que no cumple con el supuesto de riesgo proporcional. Este procedimiento permite corregir el sesgo en la estimación del parámetro, que puede presentarse cuando se viola el supuesto de riesgo proporcional. Sin embargo, presenta una desventaja y es que no existe ningún <span class="math inline">\(\beta\)</span> que permita estimar el efecto de la covariable de estratificación.</p>
<p>Continuando con nuestro ejemplo, vimos que la variable decr violaba el supuesto de proporcionalidad. Deberíamos entonces usar un modelo de Cox estratificado, donde decr sea la variable de estratificación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>m5st <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="at">formula =</span> <span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase <span class="sc">+</span> deag <span class="sc">+</span> <span class="fu">strata</span>(decr), <span class="at">data =</span> tmo)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tiempo, status) ~ fase + deag + strata(decr), 
    data = tmo)

  n= 96, number of events= 49 

                coef exp(coef) se(coef)      z Pr(&gt;|z|)    
fasecb       0.09209   1.09647  0.54271  0.170 0.865250    
fasecrónica -0.72569   0.48399  0.35111 -2.067 0.038747 *  
deagsi       1.12109   3.06819  0.32007  3.503 0.000461 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
fasecb          1.096     0.9120    0.3785    3.1765
fasecrónica     0.484     2.0662    0.2432    0.9632
deagsi          3.068     0.3259    1.6385    5.7454

Concordance= 0.646  (se = 0.041 )
Likelihood ratio test= 17.02  on 3 df,   p=7e-04
Wald test            = 17.36  on 3 df,   p=6e-04
Score (logrank) test = 18.52  on 3 df,   p=3e-04</code></pre>
</div>
</div>
<p>Podemos nuevamente chequear la proporcionalidad en este nuevo modelo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(m5st, <span class="at">transform=</span><span class="st">"km"</span>, <span class="at">global=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        chisq df      p
fase   10.848  2 0.0044
deag    0.448  1 0.5031
GLOBAL 11.084  3 0.0113</code></pre>
</div>
</div>
<p>Y vemos que ahora sí se cumplen los presupuestos del modelo.</p>
</section>
<section id="modelo-de-cox-extendido" class="level2">
<h2 class="anchored" data-anchor-id="modelo-de-cox-extendido">Modelo de Cox extendido</h2>
<p>El modelo de Cox que vimos inicialmente asume que las covariables no varían en el transcurso del tiempo. Pero sabemos que esto no siempre es así.</p>
<p><em>¿Cómo analizar la supervivencia cuando las covariables cambian con el tiempo, como edad, tratamiento o hábitos alimentarios?</em></p>
<p>El modelo de Cox extendido aborda esta situación mediante un proceso de conteo. Tiene las mismas premisas del modelo de Cox</p>
<p><span class="math display">\[h(t|x(t))= h_0(t)exp(x(t)\beta)\]</span> ¿Cuál es la diferencia? La primer diferencia está ya en la base de datos: tendremos más de una fila por individuo, dado que los valores de una variable para el mismo individuo cambian con el correr del tiempo.</p>
</section>
<section id="análisis-de-supervivencia-más-complejos" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-supervivencia-más-complejos">Análisis de supervivencia más complejos</h2>
<p>Hasta ahora, vimos modelos de supervivencia adecuados para tratar problemas en los cuales el evento ocurre una única vez. Pero existen situaciones en lo que esto no es así y podríamos estar interesados en eventos que pueden acontecer más de una vez para un mismo individuo, como: infartos, gestaciones, fracturas, internaciones, etc. Así también nos podrían interesar situaciones en las que existen diferentes tipos de eventos derivados de un mismo factor de riesgo en el estudio: efectos adversos por medicamentos, enfermedades oportunistas en SIDA, etc. Este análisis se conoce como <em>Supervivencia de eventos múltiples</em>.</p>
<p>El análisis de eventos múltiples, pretende responder a dos preguntas básicas:</p>
<ol type="1">
<li><p>¿Cuáles son los factores de riesgo asociados a los tiempos de diferentes eventos en un mismo individuo?</p></li>
<li><p>¿Cómo analizar diferentes eventos como desenlace de una misma situación de riesgo?</p></li>
</ol>
<p>Las principales características de este tipo de análisis son:</p>
<ul>
<li><p>Tener más de un tiempo de supervivencia por individuo.</p></li>
<li><p>Los individuos pueden mantenerse en el grupo de riesgo aún después de la ocurrencia de algún evento.</p></li>
</ul>
<p>Dado que los intervalos de tiempo no son independientes entre sí, la utilización directa del modelo de Cox no sirve. A su vez, no tener independencia entre las observaciones puede generar error en las estimaciones.</p>
<p>Las estrategias para resolver estas situaciones son varias:</p>
<ul>
<li><p>Ajustar un modelo de regresión en el que la variable respuesta es el número de eventos por paciente durante el período de estudio: Poisson</p></li>
<li><p>Utilizar Cox considerando uno de los eventos: tiempo hasta el primer evento</p></li>
<li><p>Utilizar Modelos multinivel</p></li>
<li><p>Utilizar Modelos marginales</p></li>
</ul>
<p>A continuación presentaremos una clasificación de eventos múltiples, la cual no es rígida ni definitiva, dado que la evolución de métodos en esta área es grande y van surgiendo nuevos modelos, que se adecúan mejor a las situaciones analizadas.</p>
<ul>
<li><p><strong>Eventos Competitivos</strong>: sólo es posible observar tiempo hasta un evento primero que impide que otro tenga lugar. Ej; muerte x diferentes causas y un mismo factor de riesgo</p></li>
<li><p><strong>Eventos Paralelos</strong>: la ocurrencia de un evento no excluye la aparición de otros eventos y no existe orden preferencial (Enfermedades oportunistas, los efectos secundarios, la pérdida de dientes)</p></li>
<li><p><strong>Eventos Ordenados</strong>: la sucesión de tiempos sigue obligatoriamente un orden. Ej: IAM El riesgo subyacente cambia a medida que el individuo sufre nuevos eventos, es decir, los eventos, además de ordenarse en el tiempo, se ordenan según el riesgo basal.</p></li>
</ul>
<p>Como podrán intuir el análisis se complejiza aún más, por lo cual no los abordaremos en este curso. Solamente hemos presentado los lineamientos, para que ustedes sean capaces de reconocer situaciones donde se deben aplicar estas metodologías, con el fin de que no cometan errores metodológicos importantes en el futuro (al menos referidos a estos temas).</p>
</section>
<section id="consideraciones-sobre-el-tamaño-de-la-muestra" class="level2">
<h2 class="anchored" data-anchor-id="consideraciones-sobre-el-tamaño-de-la-muestra">Consideraciones sobre el tamaño de la muestra</h2>
<p>Como ya hemos visto en la primera unidad, para determinar el tamaño de muestra necesario para un estudio, tendremos que tener una idea de la magnitud del efecto que deseamos detectar. En el análisis de supervivencia, el efecto es el HR, por ejemplo, a los 5 años, a los 10 años o al intervalo de tiempo que se desee.</p>
<p>Supongamos que deseamos saber si existen diferencias entre dos terapias diferentes A y B utilizadas habitualmente para tratar un determinado tipo de cáncer. Para ello se planea realizar un estudio de supervivencia. <em>¿Cuántos pacientes deberán estudiarse con cada tratamiento si se desea calcular el riesgo relativo con una precisión del 50% de su valor real y una seguridad del 95%?</em> De experiencias previas, se estima que el valor real del riesgo relativo es aproximadamente igual a 3 y la probabilidad de fallecer entre los pacientes tratados con el tratamiento A de un 20%.</p>
<p>En este caso, para conocer si el tratamiento A tiene un efecto beneficioso sobre la evolución de los enfermos, podremos utilizar un modelo de regresión de Cox en el que se ajuste por la variable tratamiento, y a partir de cuyos coeficientes podremos estimar el HR asociado a la terapia recibida. Si, con este procedimiento, deseamos calcular el tamaño muestral mínimo necesario para detectar un determinado HR, deberemos conocer:</p>
<ul>
<li><p>Una idea del valor aproximado del riesgo relativo que se desea detectar (HR).</p></li>
<li><p>La proporción de expuestos al factor de estudio (p), es decir, en nuestro caso, la proporción de enfermos habitualmente tratados con la terapia A.</p></li>
<li><p>El porcentaje de observaciones censuradas que se espera en el total de la muestra (%C).</p></li>
<li><p>El nivel de confianza o seguridad con el que se desea trabajar α.</p></li>
<li><p>El poder que se quiere para el estudio (1−β)</p></li>
</ul>
<p>Con estos datos, el cálculo del tamaño muestral puede abordarse mediante la fórmula:</p>
<p><span class="math display">\[n= \frac{(z_{1-\alpha/2}+z_{1+\beta})^2}{(log(HR))^2*(1-\%C)*(1-p)*p}\]</span></p>
<p><strong>Ejemplo</strong></p>
<p>Supongamos que el tratamiento (A) suele aplicarse a un 70% de los pacientes que padecen ese tipo de cáncer, mientras que la otra terapia (B) es recibida sólo por un 30% de los enfermos. Si el efecto pronóstico del tratamiento recibido va a analizarse de modo univariado, la ecuación puede aplicarse para calcular el número necesario de pacientes a estudiar. Así, para detectar un riesgo relativo de 3, suponiendo un 20% de censura y trabajando con un <span class="math inline">\(\alpha\)</span>= 95% y un poder del 80% se tendría:</p>
<p><span class="math display">\[n= \frac{(1.96+0.842)^2}{(log3)^2*(1-0.2)*(1-0.7)*0.7}= 47\]</span></p>
<p>Necesitaríamos 47 pacientes para detectar un HR de 3. A menor HR, mayor tamaño de muestra.</p>
<p>Si ahora deseamos usar un modelo de Cox con más variables, el tratar de ajustar un modelo más complejo con el mismo número de pacientes llevará consigo una pérdida de precisión en la estimación de los coeficientes y, con ello, del HR asociado a cada una de las variables incluidas en el modelo multivariante. En esta situación, es obvio, que se necesita realizar alguna corrección en la ecuación que permita adaptar el tamaño muestral calculado a las variables que se incluirán a posteriori en el modelo.</p>
<p><span class="math display">\[n= \frac{(z_{1-\alpha/2}+z_{1+\beta})^2}{(logHR)^2*(1-\%C)*(1-p)*p}*\frac {1}{1-\rho^2}\]</span></p>
<p>El término agregado se lo llama “factor de inflación de la varianza”, donde <span class="math inline">\(\rho\)</span> denota al coeficiente de correlación de Pearson entre el factor en estudio y aquella otra variable que incluiremos en el modelo. En el caso en el que se ajuste por más de otro factor en el modelo, lo más sencillo es considerar como el mayor coeficiente de correlación entre el factor de estudio y todas las variables incluidas. Este coeficiente de correlación, cuanto mayor sea, más incrementará el valor del factor de inflación de la varianza y, por tanto, se incrementará el tamaño de la muestra a estudiar.</p>
<p>Siguiendo con el ejemplo, posiblemente el tratamiento aplicado a cada enfermo dependerá de las características clínicas particulares del mismo, y recibirá una u otra terapia en función, por ejemplo, del estadío del tumor. En términos estadísticos, podrá entonces decirse que el factor tratamiento se encuentra “correlacionado” con esta característica. Supongamos, por ejemplo, que la correlación existente entre el nuevo tratamiento y el estadío del tumor es de 0.25. Este dato lo podremos obtener a partir de un estudio piloto o de otros trabajos sobre el tema. En caso de desconocerse, deberemos asumir una correlación suficientemente alta para así asegurar un poder suficiente.</p>
<p>El cálculo del tamaño muestral, por tanto, permite al investigador precisar el número de pacientes a estudiar para detectar como significativos efectos de una magnitud determinada. El no hacerlo, o el no conocer cuántos pacientes necesitamos para detectar un efecto como significativo podría llevarnos a cometer un error de tipo II, es decir, no encontrar diferencias cuando sí las hay.</p>
</section>
<section id="bibliografía" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Bibliografía</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-harrell1996" class="csl-entry" role="listitem">
Harrell, Frank E., Kerry L. Lee, and Daniel B. Mark. 1996. <span>“Multivariate Prognostic Models: Issues in Developing Models, Evaluating Assumptions and Adequacy, and Measuring and Reducing Errors.”</span> <em>Statistics in Medicine</em> 15 (4): 361–87. <a href="https://doi.org/10.1002/(sici)1097-0258(19960229)15:4<361::aid-sim168>3.0.co;2-4">https://doi.org/10.1002/(sici)1097-0258(19960229)15:4&lt;361::aid-sim168&gt;3.0.co;2-4</a>.
</div>
<div id="ref-hernández-ávila2011" class="csl-entry" role="listitem">
Hernández-Ávila, Mauricio. 2011. <em>Epidemiología: diseño y análisis de estudios</em>. Buenos Aires: Editorial Médica Panamericana.
</div>
<div id="ref-survminer" class="csl-entry" role="listitem">
Kassambara, Alboukadel, Marcin Kosinski, and Przemyslaw Biecek. 2021. <em>Survminer: Drawing Survival Curves Using ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=survminer">https://CRAN.R-project.org/package=survminer</a>.
</div>
<div id="ref-royo2009metodo" class="csl-entry" role="listitem">
Royo-Bordonada, Miguel Angel, Javier Damian, Beatriz Perez-Gomez, Fernando Rodrı́guez-Artalejo, Fernando Villar Alvarez, Gonzalo Lopez-Abente, Iñaki Imaz-Iglesia, et al. 2009. <span>“M<span>é</span>todo Epidemiol<span>ó</span>gico.”</span> Instituto de Salud Carlos III (ISCIII). Escuela Nacional de Sanidad (ENS).
</div>
<div id="ref-survival-book" class="csl-entry" role="listitem">
Terry M. Therneau, and Patricia M. Grambsch. 2000. <em>Modeling Survival Data: Extending the <span>C</span>ox Model</em>. New York: Springer.
</div>
<div id="ref-woodward2005epidemiology" class="csl-entry" role="listitem">
Woodward, M. 2005. <em>Epidemiology: Study Design and Data Analysis</em>. Texts in Statistical Science. Chapman &amp; Hall/CRC. <a href="https://books.google.com.ar/books?id=kcDHxgEACAAJ">https://books.google.com.ar/books?id=kcDHxgEACAAJ</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>