<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de supervivencia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#funciones-básicas-del-análisis-de-supervivencia" id="toc-funciones-básicas-del-análisis-de-supervivencia" class="nav-link active" data-scroll-target="#funciones-básicas-del-análisis-de-supervivencia">Funciones Básicas del Análisis de Supervivencia</a></li>
  <li><a href="#modelos-paramétricos-para-el-tiempo-de-supervivencia" id="toc-modelos-paramétricos-para-el-tiempo-de-supervivencia" class="nav-link" data-scroll-target="#modelos-paramétricos-para-el-tiempo-de-supervivencia">Modelos Paramétricos para el tiempo de Supervivencia</a></li>
  <li><a href="#métodos-no-paramétricos-para-el-análisis-de-supervivencia" id="toc-métodos-no-paramétricos-para-el-análisis-de-supervivencia" class="nav-link" data-scroll-target="#métodos-no-paramétricos-para-el-análisis-de-supervivencia">Métodos no paramétricos para el Análisis de Supervivencia</a></li>
  <li><a href="#comparación-de-curvas-de-supervivencia" id="toc-comparación-de-curvas-de-supervivencia" class="nav-link" data-scroll-target="#comparación-de-curvas-de-supervivencia">Comparación de Curvas de Supervivencia</a></li>
  <li><a href="#hazard-y-riesgo-acumulado" id="toc-hazard-y-riesgo-acumulado" class="nav-link" data-scroll-target="#hazard-y-riesgo-acumulado">Hazard y Riesgo acumulado</a></li>
  <li><a href="#intervalos-de-confianza-y-ee-para-la-supervivencia" id="toc-intervalos-de-confianza-y-ee-para-la-supervivencia" class="nav-link" data-scroll-target="#intervalos-de-confianza-y-ee-para-la-supervivencia">Intervalos de confianza y EE para la supervivencia</a></li>
  <li><a href="#algunas-otras-medidas-de-supervivencia" id="toc-algunas-otras-medidas-de-supervivencia" class="nav-link" data-scroll-target="#algunas-otras-medidas-de-supervivencia">Algunas otras medidas de supervivencia</a></li>
  <li><a href="#análisis-de-supervivencia-en-r" id="toc-análisis-de-supervivencia-en-r" class="nav-link" data-scroll-target="#análisis-de-supervivencia-en-r">Análisis de supervivencia en R</a></li>
  <li><a href="#comparación-de-curvas-de-supervivencia-1" id="toc-comparación-de-curvas-de-supervivencia-1" class="nav-link" data-scroll-target="#comparación-de-curvas-de-supervivencia-1">Comparación de curvas de supervivencia</a></li>
  <li><a href="#función-de-riesgo" id="toc-función-de-riesgo" class="nav-link" data-scroll-target="#función-de-riesgo">Función de riesgo</a></li>
  <li><a href="#bibliografía" id="toc-bibliografía" class="nav-link" data-scroll-target="#bibliografía">Bibliografía</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Análisis de supervivencia</strong></h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<div style="text-align: center;">
<p>Este material es parte de la <strong>Unidad 6 del Curso de Epidemiología - Nivel Avanzado del Instituto Nacional de Epidemiología “Dr.&nbsp;Juan H. Jara” - ANLIS</strong></p>
<p><a href="https://datos-ine.github.io/EpiAvanzada/unidad_6/supervivencia">Análisis de supervivencia</a> por <a href="http://www.ine.gov.ar/">Andrea Silva</a> bajo licencia <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1">CC BY-NC 4.0</a> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy43ODUiIGN5PSIyOC41MDEiIHI9IjI4LjgzNiIvPg0KCTxwYXRoIGQ9Ik0zNy40NDEtMy41YzguOTUxLDAsMTYuNTcyLDMuMTI1LDIyLjg1Nyw5LjM3MmMzLjAwOCwzLjAwOSw1LjI5NSw2LjQ0OCw2Ljg1NywxMC4zMTQNCgkJYzEuNTYxLDMuODY3LDIuMzQ0LDcuOTcxLDIuMzQ0LDEyLjMxNGMwLDQuMzgxLTAuNzczLDguNDg2LTIuMzE0LDEyLjMxM2MtMS41NDMsMy44MjgtMy44Miw3LjIxLTYuODI4LDEwLjE0Mw0KCQljLTMuMTIzLDMuMDg1LTYuNjY2LDUuNDQ4LTEwLjYyOSw3LjA4NmMtMy45NjEsMS42MzgtOC4wNTcsMi40NTctMTIuMjg1LDIuNDU3cy04LjI3Ni0wLjgwOC0xMi4xNDMtMi40MjkNCgkJYy0zLjg2Ni0xLjYxOC03LjMzMy0zLjk2MS0xMC40LTcuMDI3Yy0zLjA2Ny0zLjA2Ni01LjQtNi41MjQtNy0xMC4zNzJTNS41LDMyLjc2Nyw1LjUsMjguNWMwLTQuMjI5LDAuODA5LTguMjk1LDIuNDI4LTEyLjINCgkJYzEuNjE5LTMuOTA1LDMuOTcyLTcuNCw3LjA1Ny0xMC40ODZDMjEuMDgtMC4zOTQsMjguNTY1LTMuNSwzNy40NDEtMy41eiBNMzcuNTU3LDIuMjcyYy03LjMxNCwwLTEzLjQ2NywyLjU1My0xOC40NTgsNy42NTcNCgkJYy0yLjUxNSwyLjU1My00LjQ0OCw1LjQxOS01LjgsOC42Yy0xLjM1NCwzLjE4MS0yLjAyOSw2LjUwNS0yLjAyOSw5Ljk3MmMwLDMuNDI5LDAuNjc1LDYuNzM0LDIuMDI5LDkuOTEzDQoJCWMxLjM1MywzLjE4MywzLjI4NSw2LjAyMSw1LjgsOC41MTZjMi41MTQsMi40OTYsNS4zNTEsNC4zOTksOC41MTUsNS43MTVjMy4xNjEsMS4zMTQsNi40NzYsMS45NzEsOS45NDMsMS45NzENCgkJYzMuNDI4LDAsNi43NS0wLjY2NSw5Ljk3My0xLjk5OWMzLjIxOS0xLjMzNSw2LjEyMS0zLjI1Nyw4LjcxMy01Ljc3MWM0Ljk5LTQuODc2LDcuNDg0LTEwLjk5LDcuNDg0LTE4LjM0NA0KCQljMC0zLjU0My0wLjY0OC02Ljg5NS0xLjk0My0xMC4wNTdjLTEuMjkzLTMuMTYyLTMuMTgtNS45OC01LjY1NC04LjQ1OEM1MC45ODQsNC44NDQsNDQuNzk1LDIuMjcyLDM3LjU1NywyLjI3MnogTTM3LjE1NiwyMy4xODcNCgkJbC00LjI4NywyLjIyOWMtMC40NTgtMC45NTEtMS4wMTktMS42MTktMS42ODUtMmMtMC42NjctMC4zOC0xLjI4Ni0wLjU3MS0xLjg1OC0wLjU3MWMtMi44NTYsMC00LjI4NiwxLjg4NS00LjI4Niw1LjY1Nw0KCQljMCwxLjcxNCwwLjM2MiwzLjA4NCwxLjA4NSw0LjExM2MwLjcyNCwxLjAyOSwxLjc5MSwxLjU0NCwzLjIwMSwxLjU0NGMxLjg2NywwLDMuMTgxLTAuOTE1LDMuOTQ0LTIuNzQzbDMuOTQyLDINCgkJYy0wLjgzOCwxLjU2My0yLDIuNzkxLTMuNDg2LDMuNjg2Yy0xLjQ4NCwwLjg5Ni0zLjEyMywxLjM0My00LjkxNCwxLjM0M2MtMi44NTcsMC01LjE2My0wLjg3NS02LjkxNS0yLjYyOQ0KCQljLTEuNzUyLTEuNzUyLTIuNjI4LTQuMTktMi42MjgtNy4zMTNjMC0zLjA0OCwwLjg4Ni01LjQ2NiwyLjY1Ny03LjI1N2MxLjc3MS0xLjc5LDQuMDA5LTIuNjg2LDYuNzE1LTIuNjg2DQoJCUMzMi42MDQsMTguNTU4LDM1LjQ0MSwyMC4xMDEsMzcuMTU2LDIzLjE4N3ogTTU1LjYxMywyMy4xODdsLTQuMjI5LDIuMjI5Yy0wLjQ1Ny0wLjk1MS0xLjAyLTEuNjE5LTEuNjg2LTINCgkJYy0wLjY2OC0wLjM4LTEuMzA3LTAuNTcxLTEuOTE0LTAuNTcxYy0yLjg1NywwLTQuMjg3LDEuODg1LTQuMjg3LDUuNjU3YzAsMS43MTQsMC4zNjMsMy4wODQsMS4wODYsNC4xMTMNCgkJYzAuNzIzLDEuMDI5LDEuNzg5LDEuNTQ0LDMuMjAxLDEuNTQ0YzEuODY1LDAsMy4xOC0wLjkxNSwzLjk0MS0yLjc0M2w0LDJjLTAuODc1LDEuNTYzLTIuMDU3LDIuNzkxLTMuNTQxLDMuNjg2DQoJCWMtMS40ODYsMC44OTYtMy4xMDUsMS4zNDMtNC44NTcsMS4zNDNjLTIuODk2LDAtNS4yMDktMC44NzUtNi45NDEtMi42MjljLTEuNzM2LTEuNzUyLTIuNjAyLTQuMTktMi42MDItNy4zMTMNCgkJYzAtMy4wNDgsMC44ODUtNS40NjYsMi42NTgtNy4yNTdjMS43Ny0xLjc5LDQuMDA4LTIuNjg2LDYuNzEzLTIuNjg2QzUxLjExNywxOC41NTgsNTMuOTM4LDIwLjEwMSw1NS42MTMsMjMuMTg3eiIvPg0KPC9nPg0KPC9zdmc+DQo=" class="img-fluid" style="width:4.0%"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy42MzciIGN5PSIyOC44MDYiIHI9IjI4LjI3NiIvPg0KCTxnPg0KCQk8cGF0aCBkPSJNMzcuNDQzLTMuNWM4Ljk4OCwwLDE2LjU3LDMuMDg1LDIyLjc0Miw5LjI1N0M2Ni4zOTMsMTEuOTY3LDY5LjUsMTkuNTQ4LDY5LjUsMjguNWMwLDguOTkxLTMuMDQ5LDE2LjQ3Ni05LjE0NSwyMi40NTYNCgkJCUM1My44NzksNTcuMzE5LDQ2LjI0Miw2MC41LDM3LjQ0Myw2MC41Yy04LjY0OSwwLTE2LjE1My0zLjE0NC0yMi41MTQtOS40M0M4LjY0NCw0NC43ODQsNS41LDM3LjI2Miw1LjUsMjguNQ0KCQkJYzAtOC43NjEsMy4xNDQtMTYuMzQyLDkuNDI5LTIyLjc0MkMyMS4xMDEtMC40MTUsMjguNjA0LTMuNSwzNy40NDMtMy41eiBNMzcuNTU3LDIuMjcyYy03LjI3NiwwLTEzLjQyOCwyLjU1My0xOC40NTcsNy42NTcNCgkJCWMtNS4yMiw1LjMzNC03LjgyOSwxMS41MjUtNy44MjksMTguNTcyYzAsNy4wODYsMi41OSwxMy4yMiw3Ljc3LDE4LjM5OGM1LjE4MSw1LjE4MiwxMS4zNTIsNy43NzEsMTguNTE0LDcuNzcxDQoJCQljNy4xMjMsMCwxMy4zMzQtMi42MDcsMTguNjI5LTcuODI4YzUuMDI5LTQuODM4LDcuNTQzLTEwLjk1Miw3LjU0My0xOC4zNDNjMC03LjI3Ni0yLjU1My0xMy40NjUtNy42NTYtMTguNTcxDQoJCQlDNTAuOTY3LDQuODI0LDQ0Ljc5NSwyLjI3MiwzNy41NTcsMi4yNzJ6IE00Ni4xMjksMjAuNTU3djEzLjA4NWgtMy42NTZ2MTUuNTQyaC05Ljk0NFYzMy42NDNoLTMuNjU2VjIwLjU1Nw0KCQkJYzAtMC41NzIsMC4yLTEuMDU3LDAuNTk5LTEuNDU3YzAuNDAxLTAuMzk5LDAuODg3LTAuNiwxLjQ1Ny0wLjZoMTMuMTQ0YzAuNTMzLDAsMS4wMSwwLjIsMS40MjgsMC42DQoJCQlDNDUuOTE4LDE5LjUsNDYuMTI5LDE5Ljk4Niw0Ni4xMjksMjAuNTU3eiBNMzMuMDQyLDEyLjMyOWMwLTMuMDA4LDEuNDg1LTQuNTE0LDQuNDU4LTQuNTE0czQuNDU3LDEuNTA0LDQuNDU3LDQuNTE0DQoJCQljMCwyLjk3MS0xLjQ4Niw0LjQ1Ny00LjQ1Nyw0LjQ1N1MzMy4wNDIsMTUuMywzMy4wNDIsMTIuMzI5eiIvPg0KCTwvZz4NCjwvZz4NCjwvc3ZnPg0K" class="img-fluid" style="width:4.0%"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxMy4wLjIsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDE0OTQ4KSAgLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMCIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4IiB2aWV3Qm94PSI1LjUgLTMuNSA2NCA2NCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyA1LjUgLTMuNSA2NCA2NCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Y2lyY2xlIGZpbGw9IiNGRkZGRkYiIGN4PSIzNy40NyIgY3k9IjI4LjczNiIgcj0iMjkuNDcxIi8+DQoJPGc+DQoJCTxwYXRoIGQ9Ik0zNy40NDItMy41YzguOTksMCwxNi41NzEsMy4wODUsMjIuNzQzLDkuMjU2QzY2LjM5MywxMS45MjgsNjkuNSwxOS41MDksNjkuNSwyOC41YzAsOC45OTItMy4wNDgsMTYuNDc2LTkuMTQ1LDIyLjQ1OA0KCQkJQzUzLjg4LDU3LjMyLDQ2LjI0MSw2MC41LDM3LjQ0Miw2MC41Yy04LjY4NiwwLTE2LjE5LTMuMTYyLTIyLjUxMy05LjQ4NUM4LjY0NCw0NC43MjgsNS41LDM3LjIyNSw1LjUsMjguNQ0KCQkJYzAtOC43NjIsMy4xNDQtMTYuMzQzLDkuNDI5LTIyLjc0M0MyMS4xLTAuNDE0LDI4LjYwNC0zLjUsMzcuNDQyLTMuNXogTTEyLjcsMTkuODcyYy0wLjk1MiwyLjYyOC0xLjQyOSw1LjUwNS0xLjQyOSw4LjYyOQ0KCQkJYzAsNy4wODYsMi41OSwxMy4yMiw3Ljc3LDE4LjRjNS4yMTksNS4xNDQsMTEuMzkxLDcuNzE1LDE4LjUxNCw3LjcxNWM3LjIwMSwwLDEzLjQwOS0yLjYwOCwxOC42My03LjgyOQ0KCQkJYzEuODY3LTEuNzksMy4zMzItMy42NTcsNC4zOTgtNS42MDJsLTEyLjA1Ni01LjM3MWMtMC40MjEsMi4wMi0xLjQzOSwzLjY2Ny0zLjA1Nyw0Ljk0MmMtMS42MjIsMS4yNzYtMy41MzUsMi4wMTEtNS43NDQsMi4yDQoJCQl2NC45MTVoLTMuNzE0di00LjkxNWMtMy41NDMtMC4wMzYtNi43ODItMS4zMTItOS43MTQtMy44MjdsNC40LTQuNDU3YzIuMDk0LDEuOTQyLDQuNDc2LDIuOTEzLDcuMTQzLDIuOTEzDQoJCQljMS4xMDQsMCwyLjA0OC0wLjI0NiwyLjgzLTAuNzQzYzAuNzgtMC40OTQsMS4xNzItMS4zMTIsMS4xNzItMi40NTdjMC0wLjgwMS0wLjI4Ny0xLjQ0OC0wLjg1OC0xLjk0M2wtMy4wODUtMS4zMTVsLTMuNzcxLTEuNzE1DQoJCQlsLTUuMDg2LTIuMjI5TDEyLjcsMTkuODcyeiBNMzcuNTU3LDIuMjE0Yy03LjI3NiwwLTEzLjQyOCwyLjU3MS0xOC40NTcsNy43MTRjLTEuMjU4LDEuMjU4LTIuNDM5LDIuNjg2LTMuNTQzLDQuMjg3TDI3Ljc4NiwxOS43DQoJCQljMC41MzMtMS42NzYsMS41NDItMy4wMTksMy4wMjktNC4wMjhjMS40ODQtMS4wMDksMy4yMTgtMS41NzEsNS4yLTEuNjg2VjkuMDcxaDMuNzE1djQuOTE1YzIuOTM0LDAuMTUzLDUuNiwxLjE0Myw4LDIuOTcxDQoJCQlsLTQuMTcyLDQuMjg2Yy0xLjc5My0xLjI1Ny0zLjYxOS0xLjg4NS01LjQ4Ni0xLjg4NWMtMC45OTEsMC0xLjg3NiwwLjE5MS0yLjY1NiwwLjU3MWMtMC43ODEsMC4zODEtMS4xNzIsMS4wMjktMS4xNzIsMS45NDMNCgkJCWMwLDAuMjY3LDAuMDk1LDAuNTMzLDAuMjg1LDAuOGw0LjA1NywxLjgzbDIuOCwxLjI1N2w1LjE0NCwyLjI4NWwxNi4zOTcsNy4zMTRjMC41MzUtMi4yNDgsMC44MDEtNC41MzMsMC44MDEtNi44NTcNCgkJCWMwLTcuMzUzLTIuNTUyLTEzLjU0My03LjY1Ni0xOC41NzNDNTEuMDA1LDQuNzg1LDQ0LjgzMSwyLjIxNCwzNy41NTcsMi4yMTR6Ii8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+DQo=" class="img-fluid" style="width:4.0%"></p>
</div>
<section id="funciones-básicas-del-análisis-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="funciones-básicas-del-análisis-de-supervivencia">Funciones Básicas del Análisis de Supervivencia</h2>
<p>Recordemos que en el contexto del Análisis de supervivencia se intenta modelar una variable aleatoria T no negativa, que representa el “tiempo hasta un evento determinado” de los individuos en el estudio. Para analizar esta variable se cuenta con cuatro funciones básicas:</p>
<ul>
<li><p><strong>Función densidad de probabilidad</strong>: Esta variable tiempo hasta que ocurre un evento (<span class="math inline">\(T\)</span>), como toda variable aleatoria continua tiene una función de densidad de probabilidad <span class="math inline">\(f(t)\)</span>, como vimos en la primera parte. Esta función puede ser interpretada como la probabilidad de un individuo de sufrir un evento en un intervalo instantáneo de tiempo.Existirá también una función de probabilidad acumulada <span class="math inline">\(F(t)\)</span>, que da la probabilidad de morir en un intervalo concreto de tiempo: [<span class="math inline">\(t_1\)</span>, <span class="math inline">\(t_2\)</span>].</p></li>
<li><p>La <strong>función de supervivencia <span class="math inline">\(S(t)\)</span></strong>, que presentamos en la primera parte.</p></li>
</ul>
<p>Esta función representa la probabilidad de que un individuo sobreviva (no experimente el evento) a un tiempo determinado <span class="math inline">\(t\)</span>.</p>
<ul>
<li>La <strong>función de riesgo o hazard</strong>: En el lenguaje de supervivencia suele mantenerse el término en inglés hazard que puede traducirse como “riesgo”, pero que asume ciertas particularidades. Una función de riesgo permite analizar el riego de un individuo de sufrir un evento en un determinado momento, dado que él ha sobrevivido hasta dicho momento. Por ejemplo, para responder a preguntas como: ¿cuál es el riesgo de un paciente de fallecer después de una cirugía a corazón abierto?, deberemos conocer esta función de riesgo. Por Hazard entenderemos a la tasa instantánea de un evento a tiempo <span class="math inline">\(t\)</span>. Matemáticamente, la función Hazard es definida como el riesgo instantáneo de un individuo de sufrir un evento entre el tiempo <span class="math inline">\(t\)</span> y <span class="math inline">\(t+\varepsilon\)</span>, dado que sobrevivió hasta el tiempo <span class="math inline">\(t\)</span>.</li>
</ul>
<p>Se simboliza como <span class="math inline">\(h(t)\)</span> o <span class="math inline">\(\lambda(t)\)</span> y la expresión es:</p>
<p><span class="math display">\[h(t) = \lim_{n\rightarrow \infty}((t&lt;T&lt;t+\varepsilon)|T&gt;t)/\varepsilon  \]</span> que puede interpretarse, aproximadamente, como la probabilidad de morir (en el caso que el evento sea muerte) en el intervalo (<span class="math inline">\(t\)</span>, <span class="math inline">\(t + \Delta t\)</span>], dado que se está vivo al tiempo <span class="math inline">\(t\)</span>, o bien de forma general como la probabilidad de presentar el evento en dicho intervalo. Podemos interpretarla como una medida de intensidad de muerte al tiempo <span class="math inline">\(t\)</span>, o una medida de muerte potencial al tiempo <span class="math inline">\(t\)</span>, o en forma general, como una medida de intensidad de eventos a dicho tiempo.</p>
<p>La función de riesgo recibe otros nombres como: tasa de fallo, función o tasa de incidencia, fuerza de mortalidad condicional o simplemente fuerza de mortalidad. Es importante resaltar que a pesar de llevar el nombre de riesgo; <span class="math inline">\(h(t)\)</span> es una tasa y no una probabilidad, es por eso que a veces se prefiere usar el término <em>hazard</em>. Su unidad es <span class="math inline">\(tiempo^{-1}\)</span> y puede asumir cualquier valor real mayor que cero.</p>
<p>Una característica importante de esta función, es que puede servir de guía para proponer un modelo paramétrico para el tiempo de supervivencia. Lo común en muchas áreas, es que el investigador tenga alguna idea de cómo se comporta el riesgo de falla en la población bajo estudio. Este conocimiento se puede intentar asociar con la forma de alguna función de riesgo paramétrica. Para entender un poco mejor esto último observemos detenidamente la figura 1 con diferentes formas de la función de riesgo:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Riesgos.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>El gráfico <strong>A</strong> muestra una función de riesgo constante en el tiempo. Podemos imaginar situaciones de salud que tengan este comportamiento: por ejemplo riesgo de fracturas de escolares de 5to grado durante un año. El gráfico <strong>B</strong>, muestra una función de riesgo que decrece en el tiempo. Este patrón podría ejemplificar el riesgo post-quirúrgico, que es mayor en los primeros días post cirugía y luego cae con el tiempo. El gráfico <strong>C</strong> muestra una función de riesgo que se incrementa con el tiempo. Un ejemplo de esta situación podría encontrarse en un estudio sobre “tiempo hasta la solidificación de una fractura ósea”. En un primer momento el “riesgo de solidificación” de la fractura es nulo, y a medida que transcurre el tiempo se incrementa. El resto de los gráficos presentan patrones más complejos de riesgo. Quizás puedan encontrar situaciones que sean representadas por esas curvas.</p>
<p>Para cerrar diremos que la función de riesgo marca la dinámica del proceso estudiado, al dar sus valores una adecuada aproximación a la tasa de incidencia del evento de interés.</p>
<ul>
<li><strong>Función de riesgo acumulado</strong>:</li>
</ul>
<p>A partir de la función de riesgo es posible calcular un riesgo acumulado que se simboliza como <span class="math inline">\(\Lambda(t)\)</span> o <span class="math inline">\(H(t)\)</span>. La función de riesgo acumulado mide el riesgo de ocurrencia de un evento hasta un determinado tiempo <span class="math inline">\(t\)</span>. Matemáticamente implica la suma de todos los riesgos en todos los tiempos hasta el tiempo <span class="math inline">\(t\)</span>. La expresión es:</p>
<p><span class="math display">\[H(t)=\int_0^t h(u)du \]</span> Esta función permite responder preguntas como: ¿Cuál es el riesgo de un paciente con SIDA de morir en el primer año después del diagnóstico? Y en los primeros dos años?</p>
<p>Las funciones básicas descriptas hasta aquí son matemáticamente equivalentes y representan distintas formas de describir el mismo fenómeno. Todas están relacionadas entre sí y dichas relaciones son deducibles a partir de sus expresiones. Omitiremos aquí dichas deducciones, pero hagan un acto de fe y crean en las siguientes equivalencias:</p>
<p><span class="math inline">\(S(t)=1-F(t)\)</span></p>
<p><span class="math inline">\(h(t)=-\frac{dln(S(t))}{dt}\)</span></p>
<p><span class="math inline">\(h(t)=\frac{f(t)}{S(t)}\)</span></p>
<p><span class="math inline">\(h(t)=\frac{f(t)}{1-F(t)}\)</span></p>
<p><span class="math inline">\(H(t)=-ln(S(t))\)</span></p>
<p><span class="math inline">\(S(t)=exp(-H(t))\)</span></p>
<p>Una vez que estimamos una de ellas, será posible obtener cualquiera de las demás.</p>
</section>
<section id="modelos-paramétricos-para-el-tiempo-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="modelos-paramétricos-para-el-tiempo-de-supervivencia">Modelos Paramétricos para el tiempo de Supervivencia</h2>
<p>En esencia, cualquier distribución de una variable positiva con soporte en los reales no negativos, puede ser un modelo para el tiempo de supervivencia. No obstante, existen un número reducido de distribuciones de uso común para este fin. Las funciones de densidad de probabilidad más usadas son: <strong>exponencial</strong>, <strong>Weibull</strong> y <strong>lognormal</strong>.</p>
<p><strong>Distribución exponencial:</strong></p>
<p>Al asumir que la variable aleatoria T posee una distribución exponencial, su <span class="math inline">\(f(t)\)</span> será:</p>
<p><span class="math display">\[f(t) = \alpha e^{-\alpha t} \quad (\alpha&gt;0) \]</span></p>
<p>Utilizando las relaciones entre las funciones básicas de supervivencia:</p>
<p><span class="math inline">\(S(t)=e^{-\alpha t}\)</span></p>
<p><span class="math inline">\(h(t)=\frac{f(t)}{S(t)}=\frac{\alpha e^{-\alpha t}}{e^{-\alpha t}}\)</span></p>
<p><span class="math inline">\(H(t) = -lnS(t)=\alpha t\)</span></p>
<p>Como podemos ver, al asumir una distribución exponencial para la variable “tiempo hasta que el evento se produzca”, el riesgo es constante en el tiempo y el riesgo acumulado es una función lineal del tiempo (Figura 2)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Riesgos2.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Asumir una función exponencial para los tiempos de sobrevida podría ser equivalente a otras asunciones que hemos hecho, como suponer una distribución normal para una variable: es una distribución que facilita el modelaje. En la práctica es una situación muy rara, recuerden que anteriormente imaginamos una situación de salud que tenía este comportamiento: el riesgo de fracturas de escolares de 5to grado durante un año. Pero no existen demasiadas situaciones en salud donde el riesgo sea constante, la mayoría de las situaciones reflejan un incremento del riesgo que básicamente está vinculado al envejecimiento del individuo.</p>
<p>Uno de los parámetros que se calculan en el análisis de supervivencia, es la mediana de los tiempos de supervivencia, que es equivalente a responder: ¿en qué tiempo mueren (o sobreviven) la mitad de los pacientes? Para el caso de la distribución exponencial:</p>
<p><span class="math inline">\(S(t)=e^{-\alpha t}=0,5\)</span></p>
<p><span class="math inline">\(-\alpha t=ln(0,5)\)</span></p>
<p><span class="math inline">\(\alpha t=ln2\)</span></p>
<p><span class="math inline">\(T_{mediano}=\frac{ln2}{\alpha}\)</span></p>
<p>A pesar de la simplicidad del modelo exponencial, la suposición de riesgo constante en el tiempo, lo hace poco plausible para su aplicación en salud.</p>
<p><strong>Distribución Weibull:</strong></p>
<p>Esta distribución es una generalización de la distribución exponencial, más utilizada en el área biomédica. La distribución Weibull es:</p>
<p><span class="math display">\[f(t)=\gamma\alpha^\gamma t^{\gamma-1}exp(-(\alpha t)^\gamma) \]</span></p>
<p>Siendo <span class="math inline">\(\alpha\)</span> &gt; 0 y <span class="math inline">\(\gamma\)</span> &gt; 0. A partir de esta expresión, se deducen:</p>
<p><span class="math inline">\(S(t)=exp(-(\alpha t)^\gamma)\)</span></p>
<p><span class="math inline">\(h(t) = \gamma\alpha^\gamma t^{\gamma-1}\)</span></p>
<p><span class="math inline">\(H(t)=-lnS(t)=(\alpha t)^{\gamma-1}\)</span></p>
<p>Como vemos, la distribución Weibull tiene dos parámetros: <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\gamma\)</span>. El parámetro <span class="math inline">\(\gamma\)</span> determina la forma de la función de riesgo (ver figura 3)</p>
<p>Si <span class="math inline">\(\gamma\)</span> &lt; 1, la función de riesgo es decreciente. Si <span class="math inline">\(\gamma\)</span> &gt; 1, la función de riesgo es creciente. Si <span class="math inline">\(\gamma\)</span> = 1, la función de riesgo es constante, siendo equivalente a la distribución exponencial.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Weibull.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para encontrar el tiempo mediano de supervivencia, procedemos en forma análoga que en la distribución exponencial.</p>
<p><span class="math inline">\(S(t)=exp(-(\alpha t)^\gamma)=0,5\)</span></p>
<p><span class="math inline">\(-(\alpha t)^\gamma=ln(0,5)\)</span></p>
<p><span class="math inline">\(T_{mediano}=\frac{ln(2)^{1/\gamma}}{\alpha}\)</span></p>
<p>Dejaremos de lado la distribución lognormal, para pasar ahora a los métodos no paramétricos de estimación.</p>
</section>
<section id="métodos-no-paramétricos-para-el-análisis-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="métodos-no-paramétricos-para-el-análisis-de-supervivencia">Métodos no paramétricos para el Análisis de Supervivencia</h2>
<p>A continuación veremos dos métodos no paramétricos de estimar las funciones básicas de supervivencia. Los mismos parten de las llamadas “tablas de vida”. En esencia, la tabla de vida describe el proceso de mortalidad de una cohorte hasta la desaparición del último de sus individuos bajo la experiencia de mortalidad observada en un período dado. Se caracterizan por finalizar con la muerte de todos los sujetos y la diferencia fundamental entre tablas la constituye la velocidad con que se alcanza ese final. La tabla de vida se utiliza básicamente en salud pública para medir la mortalidad y la supervivencia, pero también en estudios demográficos, actuariales u otros, para estudiar la longevidad, la fertilidad, las migraciones, el crecimiento de la población y calcular proyecciones de población y los años de vida sin discapacidad. En resumen, es una presentación tabular del progreso de una cohorte a través del tiempo que transcurre.</p>
<p>Las curvas de supervivencia se originan usando uno de los dos métodos siguientes: el método de Kaplan-Meier o el análisis actuarial de Cutler-Ederer, que permiten estimar la supervivencia en presencia de censura. Existe también un método no paramétrico vinculado al análisis de supervivencia que permite la estimación de la función de riesgo acumulado: el estimador de Nelson-Aalen, que no abordaremos en este curso.</p>
<p>En el <strong>método actuarial</strong>, los tiempos de supervivencia se agrupan en intervalos. La longitud del intervalo depende de la frecuencia con que ocurre el evento de interés y puede no ser de la misma longitud. La desventaja principal de este método es que da estimaciones poco precisas cuando el número de sujetos es pequeño. En muestras grandes, tiene una importancia fundamental porque influye poco sobre las estimaciones y además permite obtener una función de riesgo. Se asume que observaciones censuradas se distribuyen homogéneamente en el intervalo.</p>
<p>En el <strong>método de Kaplan Meier</strong> la probabilidad de supervivencia al tiempo t se estima considerando que es independiente de la supervivencia a otros tiempos, entonces la probabilidad de alcanzar el tiempo <span class="math inline">\(t\)</span> es el producto de alcanzar los tiempos anteriores. La característica distintiva es que la proporción acumulada que sobrevive se calcula para el tiempo de supervivencia individual de cada paciente y no se agrupan los tiempos de supervivencia en intervalos. Debido a ello, es especialmente útil en estudios con número pequeño de pacientes.</p>
<p>Vamos a intentar comprender ambos métodos a partir de ejemplos. Para ello podrán acceder a los videos explicativos correspondientes:</p>
<p><a href="https://www.youtube.com/watch?v=PZaWezVTgO4">Video Método Actuarial</a></p>
<p><a href="https://www.youtube.com/watch?v=kb5q1OC0OgI">Video Kaplan Meier</a></p>
<p>A continuación, para que puedan contar con una versión escrita de ambos videos, se resumen los contenidos de ambos. La sugerencia es que vean primero los videos porque de esa forma les resultará más fácil seguir los cálculos.</p>
<p><strong>Método actuarial:</strong></p>
<p>Consideremos el ejemplo de estudiar la supervivencia pos trasplante hepático de un grupo de 300 pacientes durante cinco años. El estudio inició en el 2009 y terminó en el 2014. La información se muestra en la Tabla 1</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla1.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para interpretar la información de la tabla, es necesario considerar que la misma presenta la evolución anual de los pacientes que fueron admitidos en el estudio año a año. Durante el año 2009 fueron admitidos 60 pacientes, 21 de los cuales murieron ese mismo año, se registraron 4 pérdidas en el seguimiento (por lo tanto se ignora si sobreviven o han fallecido) y 1 paciente falleció por causa ajena al trasplante. Estos últimos 4 pacientes y 1 paciente, corresponden a observaciones <em>censuradas</em>. Para el año 2010, 34 quedaron vivos e iniciaron su segundo año de seguimiento. En paralelo, en el año 2010, ingresaron 67 personas al estudio.</p>
<p>Todos los pacientes que ingresaron durante cada uno de los años contribuyen con información a lo que ocurre el primer año de supervivencia. Hay un total de 300 pacientes que ingresaron vivos al estudio (60+67+53+64+56=300). Durante el primer año de seguimiento, murieron 103 pacientes (21+23+18+22+19= 103).</p>
<p>¿Cómo calculamos la probabilidad de morir en cada período? Podríamos dividir el número de muertes en cada período sobre el número de individuos vivos al comienzo del periodo o individuos en riesgo de sufrir el evento al comienzo del periodo de observación.</p>
<p>Pero; ¿qué hacemos con los sujetos que se perdieron, es decir los individuos censurados? Al clasificar los datos en intervalos de tiempo discretos (como hemos hecho en nuestra tabla), no podremos decir en qué momento se han perdido exactamente: ¿diremos que han sido individuos en riesgo durante todo el año (o período? Lo que el método actuarial asume es una solución “salomónica”: lo contaremos como mitad de persona-año.</p>
<p><span class="math display">\[P(morir)=\frac{muertes\; en \; el \; período}{indiv.en\;riesgo\;al\;comienzo\;del\;período-\frac{indiv.censurados}{2}}\]</span></p>
<p>Recordemos que los individuos censurados serán quienes están vivos al final del periodo, los que se han perdido y quienes han muerto por causas ajenas al estudio. En nuestra nueva tabla (Tabla 2), esta probabilidad se notará como <span class="math inline">\(q_i\)</span></p>
<p>Por lo tanto, para el primer periodo</p>
<p><span class="math display">\[q_i = \frac{103}{300-\frac{23+34}{2}}=0,379\]</span></p>
<p>Calcularemos también <span class="math inline">\(p_i\)</span> que denota la probabilidad de sobrevivir a un determinado periodo, dado que se ha ingresado vivo al mismo.</p>
<p>Es una probabilidad condicionada de supervivencia, y es igual a <span class="math inline">\(1 - q\)</span>.</p>
<p>Y luego calcularemos <span class="math inline">\(S(t)\)</span>, que muestra la probabilidad acumulada de sobrevivir, es decir la probabilidad que tiene una persona de sobrevivir hasta un tiempo determinado, considerando que ha sobrevivido a los tiempos anteriores. Esta probabilidad se obtiene multiplicando las probabilidades de haber sobrevivido a los tiempos anteriores. Es decir que la probabilidad de sobrevivir al tercer año a partir del trasplante será</p>
<p><span class="math inline">\(S(3)=0,621*0,789*0,868= 0,425\)</span>, es decir el 42,5%</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla2.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Puede luego graficarse <span class="math inline">\(S(t)\)</span> vs periodo (ver Figura 4). Sobre el gráfico se pueden ubicar los cuartiles y en particular, la mediana de los tiempos de supervivencia, que indica el momento donde la supervivencia es del 50%.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/FuncionS.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Método de Kaplan Meier</strong></p>
<p>El Método de Kaplan Meier (KM) utiliza esencialmente la misma estrategia que el actuarial, pero permite trabajar con menos observaciones e incluso en periodos más cortos. Para ello toma la información de cada sujeto de observación, en vez de agruparla por periodos. Similarmente a lo que vimos en el método actuarial, la probabilidad de supervivencia al tiempo <span class="math inline">\(t\)</span> se estima considerando que es independiente de la supervivencia a otros tiempos, entonces la probabilidad de alcanzar el tiempo <span class="math inline">\(t\)</span> es el producto de alcanzar los tiempos anteriores</p>
<p><span class="math display">\[S_{KM}(t)=\prod_{i:ti&lt;t}(1-d_i/n_1) \]</span> <span class="math inline">\(d_i\)</span>: Número de eventos en el tiempo <span class="math inline">\(t_i\)</span></p>
<p><span class="math inline">\(n_i\)</span>: Número de personas expuestas en el tiempo <span class="math inline">\(t_i\)</span></p>
<p>Aclaremos el método de KM con un ejemplo. Para hacerlo más simple, consideremos ahora una cohorte cerrada de 10 pacientes (Figura 5). El estudio está planteado a dos años de seguimiento. El evento a observar es muerte por enfermedad cardiovascular (ECV). En el gráfico, C significa censurado y M muerte por ECV.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/KM1.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Figura 5: Cohorte cerrada de 10 pacientes en seguimiento.</em></p>
<p>La información de la Figura 5 se transcribió en la Tabla 3. En este punto, es importante señalar que una base de datos para análisis de supervivencia, debe tener esa estructura: cada fila es un individuo en seguimiento, debe consignarse el tiempo inicial y el tiempo final del seguimiento (en este caso, el tiempo inicial es el mismo para todos porque se trata de una cohorte cerrada, pero esto no es lo más frecuente), el <span class="math inline">\(t\)</span> corresponde a tiempo de seguimiento (se obtiene de la diferencia tiempo final y tiempo inicial) y la variable status, que indica si el paciente sufrió el evento o es un paciente censurado (evento=1, censurado=0).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla3.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para la construcción de la tabla de supervivencia, lo primero que debemos hacer es ordenar los pacientes de acuerdo a su tiempo.</p>
<p>Entonces, la tabla 3, se transforma en la Tabla 4:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla4.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
<p>Comencemos con la construcción de la tabla de supervivencia (Tabla 5), teniendo en cuenta que aquí conocemos exactamente el tiempo en el que un individuo estuvo en riesgo de morir por ECV. Esta tabla se construye a partir de los individuos que tuvieron el evento.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla5.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Tabla 5: Tabla de supervivencia según KM para pacientes con ECV</em></p>
<p>Una vez obtenida la <span class="math inline">\(S(t)\)</span>, se grafica(Figura 6).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Figura6.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>Las curvas de supervivencia de Kaplan-Meier son curvas escalonadas. Los escalones se forman a medida que transcurre el tiempo, de modo que cada vez que ocurre el evento de estudio se genera un escalón hacia abajo, lo cual conlleva una reducción de la supervivencia acumulada hasta ese instante.</p>
<p>Resumiendo, para construir una curva de supervivencia se deben dar los siguientes pasos:</p>
<ol type="a">
<li><p>Ordenar ascendentemente los tiempos de supervivencia (o tiempos de observación).</p></li>
<li><p>Hacer una cuadro donde una columna (<span class="math inline">\(t_i\)</span>) corresponda a los tiempos de observación para cada participante y otra al estado de los individuos al finalizar su periodo de seguimiento (status)</p></li>
<li><p>Calcular para cada periodo de tiempo el cociente entre los que sobreviven y los que están a riesgo de sufrir el evento (<span class="math inline">\(s_i\)</span>/<span class="math inline">\(n_i\)</span>: probabilidad de supervivencia). Se crea otra columna para estos cocientes entre quienes sobreviven (<span class="math inline">\(s_i\)</span>) y los que están en riesgo (<span class="math inline">\(n_i\)</span>) de fallecer (son los que entran vivos en ese tiempo). En esta columna sólo hay datos para cuando alguien fallece. Es importante hacer notar que entre los que entran a riesgo de morir (<span class="math inline">\(n_i\)</span>) se incluyen también el individuo o individuos que van a morir en ese periodo, aunque mueran justamente en el inicio del periodo.</p></li>
<li><p>Multiplicar en cada periodo de tiempo los cocientes (<span class="math inline">\(s_i\)</span>/<span class="math inline">\(n_i\)</span>) por los de los tiempos anteriores. La supervivencia en ese momento será precisamente este producto (supervivencia acumulada)</p></li>
<li><p>Finalmente, siempre es recomendable representarlo gráficamente. Se debe empezar con una supervivencia de 1, que se mantiene hasta que se produce el primer fallecimiento. En ese momento la gráfica da un salto correspondiente al descenso de la supervivencia a partir de ese momento (en el ejemplo pasa a 0,90). Y así sucesivamente.</p></li>
</ol>
<p>Algunos investigadores prefieren generar <strong>curvas de incidencia acumulada</strong>, que muestran las probabilidades acumuladas de experimentar el evento de interés. La incidencia acumulada o probabilidad de fallo acumulativo, pueden calcularse y graficarse fácilmente a partir de la tabla de vida utilizando el método de Kaplan-Meier. En nuestro ejemplo (Tabla 5), lo haríamos a partir de la columna “Probabilidad del evento”, y luego haríamos la probabilidad acumulada, multiplicando las probabilidades a distintos tiempos.</p>
<p>Hasta aquí aprendimos a calcular la <span class="math inline">\(S(t)\)</span> a partir de nuestros datos, ya sea por el método actuarial o por el de KM. Todo esto que hicimos “a mano” aquí, las funciones del lenguaje R lo hacen y nos facilitan el trabajo.</p>
<p>Ahora podríamos plantearnos distintos interrogantes, según el estudio, como por ejemplo:</p>
<p>¿La curva será una buena estimación tanto para hombres como para mujeres? Es decir: ¿la variable sexo afecta al tiempo de supervivencia?</p>
<p>O también: ¿el tratamiento afecta el tiempo de supervivencia? Para ello será necesario comparar curvas de supervivencia.</p>
</section>
<section id="comparación-de-curvas-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="comparación-de-curvas-de-supervivencia">Comparación de Curvas de Supervivencia</h2>
<p>¿Como podemos responder estas preguntas? La estrategia de KM es estratificar según la variable de interés (sexo en el primer ejemplo, tratamiento en el segundo) y estimar la S(t) para cada estrato. De esta forma podemos comparar las curvas gráficamente.</p>
<p>Por ejemplo, la figura 7, nos muestra las curvas de supervivencia para dos grupos de pacientes que recibieron distintos tratamientos (A y B). Si observamos las medianas de los tiempos de supervivencia (líneas punteadas), podemos ver que los pacientes que siguieron el tratamiento <span class="math inline">\(B\)</span> tienen mayores tiempos de supervivencia que los que recibieron el tratamiento <span class="math inline">\(A\)</span> (Mediana tiempos de supervivencia <span class="math inline">\(A \approx 7 \;meses\)</span>; Mediana tiempos de supervivencia <span class="math inline">\(B \approx 20 \;meses\)</span>)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Figura7.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si bien gráficamente podemos tener una idea, lo correcto es hacer una comparación en términos estadísticos. Por lo tanto, existen varios test que nos permiten comparar curvas de supervivencia. Uno de los más usados por los paquetes estadísticos es el log-rank test.</p>
<p><strong>Log-rank test</strong></p>
<ul>
<li><p>Hipótesis nula (<span class="math inline">\(H_0\)</span>): las supervivencias de los grupos que se comparan (2 o más) es la misma.</p></li>
<li><p>Hipótesis alternativa (<span class="math inline">\(H_1\)</span>): al menos uno de los grupos tiene una supervivencia diferente</p></li>
</ul>
<p>Estadístico utilizado: <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(k-1\)</span> grados de libertad, siendo <span class="math inline">\(k\)</span> el número de grupos (nº de curvas que se comparan). Equivale a testear si la incidencia de eventos es semejante en cada estrato.</p>
<p>La interpretación es similar a los demás test de contraste de hipótesis. En general, se asume un <em>p= 0,05</em> para hablar de diferencias “estadísticamente significativas”.</p>
<p>Muchas veces, en el ámbito de la medicina, para comparar dos tratamientos o dos series, se tiende a usar como medida de resultado cuál es la supervivencia de los pacientes a los 5 años. Pero esto es básicamente incorrecto. Dos situaciones muy distintas pueden dar lugar a los mismos resultados de supervivencia a 5 años, como la que se muestra en la Figura 8.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Figura8.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>En la Figura8, los grupos A y B tienen exactamente una supervivencia del 50% a los 5 años. Sin embargo, se observa claramente que los pacientes del grupo B tienen una peor supervivencia desde el principio del estudio.</p>
<p>Los tests específicamente diseñados para comparar curvas de supervivencia, tienen en cuenta toda la historia de seguimiento de los pacientes en vez de considerar sólo un punto en el tiempo, es decir detectan diferencias persistentes a lo largo del tiempo en la supervivencia.</p>
<p>Cuando el evento de resultado es poco frecuente o si las curvas son aproximadamente paralelas (no se cruzan) el log-rank es el método más indicado. También se le conoce como test de Mantel y Haenszel. Cuando las curvas se cruzan (al principio hay mejor supervivencia en un grupo y luego en el otro), entonces puede estar indicado el uso de otro test de comparación de curvas de supervivencia que se llama de Wilcoxon (o también de Breslow). Un tercer test que se emplea con menos frecuencia es el de Tarone–Ware. En estos tests se hace una ponderación y se le da distinto peso a las diferencias según ocurran más precoz o más tardíamente a lo largo del seguimiento.</p>
</section>
<section id="hazard-y-riesgo-acumulado" class="level2">
<h2 class="anchored" data-anchor-id="hazard-y-riesgo-acumulado">Hazard y Riesgo acumulado</h2>
<p>Ya hemos estimado <span class="math inline">\(S(t)\)</span>, ahora nos falta abordar las otras funciones básicas de supervivencia</p>
<p>La expresión compleja de <span class="math inline">\(h(t)\)</span>, a los efectos de las Tablas de Supervivencia, puede reemplazarse por:</p>
<p><span class="math display">\[\lambda(t)=\frac{Número \; de \; \;eventos\;observados\;en\;cada\;intervalo}{personas\;en\;riesgo\;al\;inicio*amplitud\;intervalo}\]</span></p>
<p>De la misma forma que construimos <span class="math inline">\(S(t)\)</span>, podemos estimar <span class="math inline">\(h(t)\)</span> ( o un software puede hacerlo por nosotros). La Tabla 6, nos muestra las estimaciones para el ejemplo utilizado para KM.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tabla6.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>¿Qué expresa <span class="math inline">\(h(t)\)</span> o <span class="math inline">\(\lambda(t)\)</span>?</p>
<p>Observemos que la función de riesgo <span class="math inline">\(h(t)\)</span> o <span class="math inline">\(\lambda(t)\)</span> es una medida de la probabilidad de que se produzca el suceso estudiado entre los que quedan sin haber sufrido todavía tal suceso.</p>
<p>Es realmente una función que evalúa, puntualmente, en un período de tiempo determinado, la probabilidad de que un individuo de los que todavía no han sufrido tal suceso lo sufra precisamente en ese período de tiempo. Es, por lo tanto, realmente, una función que mide el riesgo en un período de tiempo concreto.</p>
<p>De forma similar, la expresión para el riesgo acumulado:</p>
<p><span class="math display">\[H(t)=\int_0^t h(u)du \]</span></p>
<p>puede aproximarse como:</p>
<p><span class="math display">\[\Lambda(t)=\sum\lambda(t)*intervalo\]</span> No mostramos aquí los cálculos correspondientes para no agobiarlos más, pero pueden intentarlo si están motivados.</p>
</section>
<section id="intervalos-de-confianza-y-ee-para-la-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="intervalos-de-confianza-y-ee-para-la-supervivencia">Intervalos de confianza y EE para la supervivencia</h2>
<p>Si se desea calcular un intervalo de confianza para la estimación de la supervivencia a un determinado tiempo se puede realizar a partir del <strong>error estándar</strong> de cada estimación de la supervivencia acumulada. Este error estándar para cada tiempo (EE ) es el producto de la supervivencia estimada para ese tiempo por la raíz de la suma de los cocientes entre el número de fallecidos en cada momento y el producto de supervivientes y pacientes en riesgo en ese tiempo.</p>
<p><span class="math display">\[EE_{S_t}=S_t\sqrt{\sum\frac{n_i-s_i}{n_is_i}} \]</span></p>
<p>Para calcular el IC95%, podríamos pensar en usar la fórmula que vimos inicialmente:</p>
<p><strong>IC 95% <span class="math inline">\(S_t\)</span> = Superv <span class="math inline">\(t\)</span> ± 1,96 EE</strong> (1,96 es el valor z de la normal para un error alfa bilateral del 5%)</p>
<p>Esta fórmula proporciona intervalos de confianza que son negativos y otros que exceden de 1,0, lo cual es absurdo. Por eso se utiliza una expresión más adecuada, calculando un error estándar transformado.</p>
<p><span class="math display">\[EE_t=\sqrt{\frac{1}{(ln[S])^2}\times\sum\frac{n_i-s_i}{n_is_i}} \]</span></p>
<p>Y a partir de este EEt, calcular el IC 95%, según la expresión:</p>
<p><strong>IC 95% <span class="math inline">\(S_t\)</span> = <span class="math inline">\(S_t\)</span> exp (<span class="math inline">\(\pm\)</span> 1, 96<span class="math inline">\(EE_t\)</span>)</strong></p>
<p>Como ya hemos dicho, las funciones del lenguaje R harán estos cálculos, aquí estamos mostrando cuál es el fundamento de lo que hacen.</p>
</section>
<section id="algunas-otras-medidas-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="algunas-otras-medidas-de-supervivencia">Algunas otras medidas de supervivencia</h2>
<p>En la literatura científica, muchas veces nos encontramos con otras medidas de supervivencia, que puntualizaremos a continuación:</p>
<ul>
<li><p>Supervivencia a 5 años: es el número de personas aún vivas después de 5 años del diagnóstico.</p></li>
<li><p>Supervivencia media: tener en cuenta sólo aquellos individuos de los que se tienen datos completos y se conoce con exactitud su situación clínica. Esta se calcula por:</p></li>
</ul>
<p><span class="math display">\[S \;media=\frac{\sum tiempo\;hasta\;alcanzar\;el\;evento}{numero\;total\;de\;individuos\;que\;tuvieron\;el\;evento} \]</span></p>
<ul>
<li>Tasa de supervivencia: Se obtiene según la fórmula</li>
</ul>
<p><span class="math display">\[Tasa\;de\;supervivencia= \frac{nro.\;de\;individuos\;que\;sobreviven\;hasta\;un\;tiempo\;t}{nro.\;total\;de\;individuos}  \]</span></p>
<ul>
<li>Tasa de Incidencia: Puede calcularse también una tasa de incidencia del evento de interés</li>
</ul>
<p><span class="math display">\[Tasa\;de\;incidencia=\frac{numero\; de\; eventos}{\sum tiempo-persona \; en\;seguimiento}  \]</span></p>
</section>
<section id="análisis-de-supervivencia-en-r" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-supervivencia-en-r">Análisis de supervivencia en R</h2>
<p>A continuación veremos un ejemplo para aprender a realizar un análisis de supervivencia en R.</p>
<p>Hasta hace pocos años, el trasplante de médula ósea (<strong>TMO</strong>) de donante compatible era el único tratamiento para la Leucemia Mieloide Crónica (<strong>LMC</strong>). Una de las causas de fracaso de este procedimiento es la enfermedad injerto contra huésped, que ocurre en 25-30 % de los pacientes sometidos a trasplante. Existen complicaciones derivadas de tratamientos quimioterapéuticos o radioterapéuticos. Además, el pronóstico de los pacientes se asocia a la fase de la enfermedad al momento del trasplante: los pacientes trasplantados en la primera fase crónica tienden a tener una mayor sobrevida. El Centro de Trasplante de Médula Ósea del Instituto Nacional del Cáncer de Brasil, realizó entre 1986 y 1998, 96 trasplantes de médula ósea para tratamiento de LMC. El análisis de los datos de esa cohorte buscaba identificar factores susceptibles de intervenciones profilácticas o terapéuticas que pudiesen mejorar el pronóstico de pacientes con LMC candidatos a TMO o contraindicar la realización del procedimiento en subgrupos de mayor riesgo, evaluando la posibilidad de conductas terapéuticas alternativas. Los datos del archivo <em>“tmo.txt”</em> provienen de esa cohorte de 96 pacientes sometidos a trasplante de médula ósea. Las covariables registradas para cada paciente se describen en la siguiente tabla:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Descripción</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>identificador del paciente</td>
</tr>
<tr class="even">
<td>sexo</td>
<td>M= masculino, F = femenino</td>
</tr>
<tr class="odd">
<td>edad</td>
<td>Edad al momento del trasplante (años)</td>
</tr>
<tr class="even">
<td>status</td>
<td>0 = censura, 1 = óbito</td>
</tr>
<tr class="odd">
<td>tiempo</td>
<td>tiempo hasta Fecha de óbito o censura</td>
</tr>
<tr class="even">
<td>deag</td>
<td>Enfermedad injerto-huésped aguda: no,si</td>
</tr>
<tr class="odd">
<td>decr</td>
<td>Enfermedad injerto-huésped crónica: no,si</td>
</tr>
<tr class="even">
<td>fase</td>
<td>Aguda, crónica, cb: crisis blástica</td>
</tr>
</tbody>
</table>
<p>Existen numerosas librerías para el análisis de supervivencia, nosotros aquí usaremos el <code>paquete survminer</code>, que provee funciones que facilitan el análisis y la visualización de datos de supervivencia y el <code>paquete survival</code>. Por lo tanto, antes de comenzar, deberán instalar ambos paquetes como ya han aprendido y luego activar dichas librería.</p>
<p>Comenzaremos leyendo el archivo (recordar activar los paquetes)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tmo <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"tmo.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El evento a considerar es “muerte pos-trasplante”. Comenzamos aplicando directamente la función <code>Surv()</code> y luego pasamos a la función <code>survfit()</code>. La función <code>Surv()</code> tomará los parámetros de tiempo y estado y creará un objeto de supervivencia. La función <code>survfit()</code> toma un objeto de supervivencia (el que produce <code>Surv()</code>) y crea las curvas de supervivencia. Nos centraremos en la construcción de objetos de supervivencia provenientes de datos con censura derecha, como es el caso del ejemplo, dado que son los más habituales. Pero pueden construirse diferentes objetos. Quien desee explorar estas posibilidades, consulte la documentación propia del paquete survival. Para datos censurados a la derecha, solo se necesitan dos argumentos en la función <code>Surv()</code>: un vector que indica qué tiempos se observan y censuran mientras que el segundo argumento indica si se observó el evento (1) o no (0).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>global <span class="ot">&lt;-</span> <span class="fu">Surv</span>(tmo<span class="sc">$</span>tiempo, tmo<span class="sc">$</span>status)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>global</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1000+   39   434    69   672    98  1000+  415   261    65  1000+ 1000+
[13] 1000+  347   453   281  1000+  185  1000+   79  1000+ 1000+  475  1000+
[25]  100   313  1000+  128   427    84   214   200   120    83  1000+  149 
[37] 1000+   70  1000+ 1000+   54   101   162   216    63  1000+ 1000+ 1000+
[49] 1000+ 1000+  571+   71  1000+   31   907+  210    32   865+  139   980+
[61]  320+   78    40   753+  846+  774+  522    48   587+   76   468+  434 
[73]  452+  487+  586   536+   89+  425   531+  371   489+  445+  243+  362+
[85]  370   263   383+   74   229+  236+  104   110+   54+   54+   32   342+</code></pre>
</div>
</div>
<p>Lo primero que hacemos es crear un objeto de supervivencia, utilizando las variables tiempo y status.Vemos que si llamamos a dicho objeto, algunos valores aparecen con un signo+. El signo <strong>+</strong> identifica aquellas observaciones con censura a la derecha.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>KM <span class="ot">&lt;-</span> <span class="fu">survfit</span>(global <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>KM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = global ~ 1)

      n events median 0.95LCL 0.95UCL
[1,] 96     49    453     370      NA</code></pre>
</div>
</div>
<p>Si llamamos al objeto <strong>KM</strong>, nos devuelve la información que vemos: el número de observaciones, de eventos, la mediana del tiempo de supervivencia y su IC. La función survfit crea curvas de supervivencia a partir de una fórmula (por ejemplo, Kaplan-Meier). Tiene varios argumentos opcionales.El nivel de confianza puede cambiarse usando el segundo argumento, <em>conf.int</em> (por ejemplo, conf.int = 0.90 para límites de confianza del 90%). El argumento <em>conf.type</em> describe el tipo de intervalo de confianza. Más específicamente, describe la transformación para construir el intervalo de confianza. El valor predeterminado es “log”, que equivale a la función de transformación g (t) = log (t). La opción “log-log” usa g (t) = log (-log (t)). Se crea un intervalo de confianza lineal utilizando el argumento <em>conf.type</em> = “plain”. Al igual que muchas funciones en R, la función <code>survfit()</code> devuelve información oculta a la que se puede acceder con los comandos adecuados. A continuación consideramos varios elementos de esta información oculta, que se almacena en una lista, dado que como podrán verificar el objeto KM es una lista.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>surv <span class="co"># devuelve las estimaciones de Kaplan-Meier a cada t_i</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.9895833 0.9687500 0.9583333 0.9479167 0.9375000 0.9270833 0.9164272
 [8] 0.9057711 0.8951149 0.8844588 0.8738027 0.8631466 0.8524904 0.8418343
[15] 0.8311782 0.8205220 0.8098659 0.7990677 0.7882695 0.7774713 0.7666731
[22] 0.7557206 0.7447681 0.7338156 0.7228632 0.7119107 0.7009582 0.6900057
[29] 0.6790533 0.6681008 0.6571483 0.6456194 0.6340905 0.6225616 0.6110327
[36] 0.5990516 0.5868261 0.5746005 0.5621092 0.5496179 0.5371266 0.5121440
[43] 0.4990121 0.4855252 0.4712451 0.4555369 0.4392677</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>time <span class="co"># {t_i}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  31  32  39  40  48  54  63  65  69  70  71  74  76  78  79  83  84  98 100
[20] 101 104 120 128 139 149 162 185 200 210 214 216 261 263 281 313 347 370 371
[39] 415 425 427 434 453 475 522 586 672</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>n.risk <span class="co"># {Y_i}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 96 95 93 92 91 90 87 86 85 84 83 82 81 80 79 78 77 75 74 73 72 70 69 68 67
[26] 66 65 64 63 62 61 57 56 55 54 51 49 48 46 45 44 43 39 37 34 30 28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>n.event <span class="co"># {d_i}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 2 1 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>std.err <span class="co">#  error standard de las estimaciones de  K-M a {t_i}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.01036227 0.01775805 0.02039469 0.02267769 0.02470529 0.02653610
 [7] 0.02828989 0.02990062 0.03139031 0.03277547 0.03406886 0.03528058
[13] 0.03641876 0.03749012 0.03850023 0.03945379 0.04035482 0.04123615
[19] 0.04206898 0.04285613 0.04360007 0.04433152 0.04502166 0.04567236
[25] 0.04628529 0.04686192 0.04740359 0.04791147 0.04838664 0.04883004
[31] 0.04924254 0.04970993 0.05014134 0.05053772 0.05089987 0.05129253
[37] 0.05168218 0.05203137 0.05237821 0.05268268 0.05294552 0.05334865
[43] 0.05357258 0.05379554 0.05407546 0.05450672 0.05493443</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)<span class="sc">$</span>lower <span class="co"># estimaciones puntuales inferiores (alternativamente, $upper)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.9694806 0.9345627 0.9191827 0.9044952 0.8903077 0.8765055 0.8626241
 [8] 0.8490226 0.8356578 0.8224974 0.8095165 0.7966952 0.7840176 0.7714705
[15] 0.7590431 0.7467260 0.7345115 0.7221992 0.7099816 0.6978531 0.6858088
[22] 0.6736413 0.6615542 0.6495440 0.6376072 0.6257411 0.6139430 0.6022106
[29] 0.5905417 0.5789346 0.5673875 0.5551850 0.5430523 0.5309875 0.5189890
[36] 0.5065029 0.4937914 0.4811581 0.4682787 0.4554811 0.4427639 0.4175656
[43] 0.4043229 0.3907508 0.3763321 0.3603082 0.3437786</code></pre>
</div>
</div>
<p>O bien usar directamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = global ~ 1)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
   31     96       1    0.990  0.0104        0.969        1.000
   32     95       2    0.969  0.0178        0.935        1.000
   39     93       1    0.958  0.0204        0.919        0.999
   40     92       1    0.948  0.0227        0.904        0.993
   48     91       1    0.938  0.0247        0.890        0.987
   54     90       1    0.927  0.0265        0.877        0.981
   63     87       1    0.916  0.0283        0.863        0.974
   65     86       1    0.906  0.0299        0.849        0.966
   69     85       1    0.895  0.0314        0.836        0.959
   70     84       1    0.884  0.0328        0.822        0.951
   71     83       1    0.874  0.0341        0.810        0.943
   74     82       1    0.863  0.0353        0.797        0.935
   76     81       1    0.852  0.0364        0.784        0.927
   78     80       1    0.842  0.0375        0.771        0.919
   79     79       1    0.831  0.0385        0.759        0.910
   83     78       1    0.821  0.0395        0.747        0.902
   84     77       1    0.810  0.0404        0.735        0.893
   98     75       1    0.799  0.0412        0.722        0.884
  100     74       1    0.788  0.0421        0.710        0.875
  101     73       1    0.777  0.0429        0.698        0.866
  104     72       1    0.767  0.0436        0.686        0.857
  120     70       1    0.756  0.0443        0.674        0.848
  128     69       1    0.745  0.0450        0.662        0.838
  139     68       1    0.734  0.0457        0.650        0.829
  149     67       1    0.723  0.0463        0.638        0.820
  162     66       1    0.712  0.0469        0.626        0.810
  185     65       1    0.701  0.0474        0.614        0.800
  200     64       1    0.690  0.0479        0.602        0.791
  210     63       1    0.679  0.0484        0.591        0.781
  214     62       1    0.668  0.0488        0.579        0.771
  216     61       1    0.657  0.0492        0.567        0.761
  261     57       1    0.646  0.0497        0.555        0.751
  263     56       1    0.634  0.0501        0.543        0.740
  281     55       1    0.623  0.0505        0.531        0.730
  313     54       1    0.611  0.0509        0.519        0.719
  347     51       1    0.599  0.0513        0.507        0.709
  370     49       1    0.587  0.0517        0.494        0.697
  371     48       1    0.575  0.0520        0.481        0.686
  415     46       1    0.562  0.0524        0.468        0.675
  425     45       1    0.550  0.0527        0.455        0.663
  427     44       1    0.537  0.0529        0.443        0.652
  434     43       2    0.512  0.0533        0.418        0.628
  453     39       1    0.499  0.0536        0.404        0.616
  475     37       1    0.486  0.0538        0.391        0.603
  522     34       1    0.471  0.0541        0.376        0.590
  586     30       1    0.456  0.0545        0.360        0.576
  672     28       1    0.439  0.0549        0.344        0.561</code></pre>
</div>
</div>
<p>Podemos también graficar la función de supervivencia:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(KM, <span class="at">data =</span> tmo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como se esperaba, la gráfica nos muestra las probabilidades decrecientes de supervivencia a medida que pasa el tiempo. El sombreado representa el intervalo de confianza. Veremos más adelante como podemos “customizar” este gráfico.</p>
</section>
<section id="comparación-de-curvas-de-supervivencia-1" class="level2">
<h2 class="anchored" data-anchor-id="comparación-de-curvas-de-supervivencia-1">Comparación de curvas de supervivencia</h2>
<p>Intentaremos ahora verificar los factores pronósticos para el tiempo de supervivencia post-trasplante. Recordemos que el evento a considerar es “muerte pos-trasplante”. Como herramienta exploratoria, utilizaremos las curvas de supervivencia estimadas por el método de Kaplan Meier según las covariables: Sexo, Enfermedad injerto crónica (decr), Enfermedad injerto aguda (deag), Fase. Esta parte es equivalente al análisis bivariado que realizamos en regresión lineal y logística. Recordemos que la variable que representa los tiempos de supervivencia es “tiempo” y la que representa el evento o la censura es “status”. Comenzaremos evaluando las curvas de Kaplan Meier en forma visual, y las completaremos con la información del logrank test, que es el test que nos permite comparar dos funciones de supervivencia. Para ello, comenzamos definiendo la función de supervivencia en cada caso.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>kmsex <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> <span class="fu">factor</span>(sexo), <span class="at">data =</span> tmo)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(kmsex, <span class="at">data =</span> tmo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para comparar ambas funciones de supervivencia se debe ejecutar la función <code>survdiff()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>logrank <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(tiempo,status) <span class="sc">~</span> sexo, <span class="at">data =</span> tmo)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>logrank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tiempo, status) ~ sexo, data = tmo)

        N Observed Expected (O-E)^2/E (O-E)^2/V
sexo=F 39       17     19.4     0.305     0.508
sexo=M 57       32     29.6     0.201     0.508

 Chisq= 0.5  on 1 degrees of freedom, p= 0.5 </code></pre>
</div>
</div>
<p>Podemos resumir toda la información en un único gráfico, e incluso sumarle información adicional, de acuerdo a cómo personalicemos dicho gráfico:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>  kmsex, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tmo, </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-14-4" class="code-annotation-target"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="annotated-cell-14-5"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-14-6" class="code-annotation-target"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"plum1"</span>, <span class="st">"paleturquoise2"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-14-7" class="code-annotation-target"><a href="#annotated-cell-14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-14-8" class="code-annotation-target"><a href="#annotated-cell-14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="5" onclick="event.preventDefault();" href="">5</a><span id="annotated-cell-14-9" class="code-annotation-target"><a href="#annotated-cell-14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="6" onclick="event.preventDefault();" href="">6</a><span id="annotated-cell-14-10" class="code-annotation-target"><a href="#annotated-cell-14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="annotated-cell-14-11"><a href="#annotated-cell-14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="7" onclick="event.preventDefault();" href="">7</a><span id="annotated-cell-14-12" class="code-annotation-target"><a href="#annotated-cell-14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Femenino"</span>, <span class="st">"Masculino"</span>),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="8" onclick="event.preventDefault();" href="">8</a><span id="annotated-cell-14-13" class="code-annotation-target"><a href="#annotated-cell-14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="9" onclick="event.preventDefault();" href="">9</a><span id="annotated-cell-14-14" class="code-annotation-target"><a href="#annotated-cell-14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()</span>
<span id="annotated-cell-14-15"><a href="#annotated-cell-14-15" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="4" data-code-annotation="1">cambia el tamaño de la línea</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="6" data-code-annotation="2">personaliza las paletas de colores</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="7" data-code-annotation="3">agrega intervalo de confianza</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="8" data-code-annotation="4">agrega p-value</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="9" data-code-annotation="5">agrega tabla de riesgo</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="10" data-code-annotation="6">Tabla de riesgos con diferente color según grupo</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="12" data-code-annotation="7">cambia etiqueta de la leyenda</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="13" data-code-annotation="8">útil para cambiar cuando se tienen múltiples grupos</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="14" data-code-annotation="9">Cambia “ggplot2 theme”</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hagamos lo mismo para las restantes variables del problema:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>kmdeag <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> <span class="fu">factor</span>(deag), <span class="at">data =</span> tmo)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  kmdeag, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tmo, </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,                  </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"plum1"</span>, <span class="st">"paleturquoise2"</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,              </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"NO"</span>, <span class="st">"SI"</span>),    </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()      </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>logrank <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> deag, <span class="at">data =</span> tmo)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>logrank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tiempo, status) ~ deag, data = tmo)

         N Observed Expected (O-E)^2/E (O-E)^2/V
deag=no 61       23     36.2      4.79      18.8
deag=si 35       26     12.8     13.50      18.8

 Chisq= 18.8  on 1 degrees of freedom, p= 1e-05 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>kmdecr <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> <span class="fu">factor</span>(decr), <span class="at">data =</span> tmo)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  kmdecr, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tmo, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,                  </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"plum1"</span>, <span class="st">"paleturquoise2"</span>), </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,              </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"NO"</span>, <span class="st">"SI"</span>),    </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()      </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>logrank <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> decr, <span class="at">data =</span> tmo)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>logrank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tiempo, status) ~ decr, data = tmo)

         N Observed Expected (O-E)^2/E (O-E)^2/V
decr=no 45       31     15.7     14.94      22.6
decr=si 51       18     33.3      7.04      22.6

 Chisq= 22.6  on 1 degrees of freedom, p= 2e-06 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>kmfase <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> <span class="fu">factor</span>(fase), <span class="at">data =</span> tmo)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  kmfase, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tmo, </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,                  </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"plum1"</span>, <span class="st">"paleturquoise2"</span>, <span class="st">"green"</span>), </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,              </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"aguda"</span>,<span class="st">"cb"</span>, <span class="st">"crónica"</span>),    </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>, </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()      </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>logrank <span class="ot">&lt;-</span> <span class="fu">survdiff</span>(<span class="fu">Surv</span>(tiempo, status) <span class="sc">~</span> fase, <span class="at">data =</span> tmo)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>logrank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tiempo, status) ~ fase, data = tmo)

              N Observed Expected (O-E)^2/E (O-E)^2/V
fase=aguda   20       14     8.73      3.19       3.9
fase=cb       6        6     1.50     13.49      14.3
fase=crónica 70       29    38.77      2.46      12.0

 Chisq= 19.7  on 2 degrees of freedom, p= 5e-05 </code></pre>
</div>
</div>
<p>¿Qué podemos concluir a partir de las curvas de KM? Observando cada gráfico detenidamente, vemos que:</p>
<ul>
<li><p>Para la variable sexo, las curvas se superponen bastante. Es decir que parece razonable suponer que no existe diferencia en la supervivencia post-trasplante de hombres y mujeres. Dado la forma de las curvas, parecería más correcto emplear el test de Wilcoxon. De todas formas, el valor de ambos test indica lo que ya habíamos predicho observando el gráfico: que no hay diferencia en las curvas de supervivencia entre hombres y mujeres.</p></li>
<li><p>Se observa diferencia en las curvas de supervivencia de los pacientes según hayan padecido o no enfermedad injerto contra huésped aguda: menor supervivencia para quienes padecieron (deag=si)</p></li>
<li><p>Se observa diferencia en las curvas de supervivencia de los pacientes según hayan padecido o no enfermedad injerto contra huésped crónica:menor supervivencia para quienes no padecieron (decr=no)</p></li>
<li><p>Se observa diferencia en las curvas de supervivencia de los pacientes según la fase de la enfermedad en la que se encontraban al momento del trasplante. Observen que la variable fase tiene 3 categorías. El valor del log Rank test nos indica que hay diferencia en la supervivencia de las categorías, pero no nos dice si las 3 son distintas o si sólo una difiere de las otras dos.De la observación del gráfico podemos concluir que los pacientes que sufren crisis blástica (cb) tienen una supervivencia menor, de hecho aproximadamente a los 200 días fallecen todos.</p></li>
</ul>
<p>Recordamos que KM estratifica por variables cualitativas, por lo tanto edad no puede ser evaluada de esta forma. Podría recodificarse si, para el evento en cuestión, el marco teórico señalara alguna edad de corte.</p>
<p>Volveremos sobre este ejemplo cuando abordemos el modelo de Cox.</p>
</section>
<section id="función-de-riesgo" class="level2">
<h2 class="anchored" data-anchor-id="función-de-riesgo">Función de riesgo</h2>
<p>En algunas ocasiones, y dependiendo el evento que estemos considerando, puede resultar más fácil de interpretar la función de riesgo en vez de la función de supervivencia. En nuestro ejemplo, la variable resultado a considerar es “tiempo hasta la muerte post- transplante”. En este caso, la interpretación de la función de supervivencia no reviste ninguna dificultad. Pero en aquellos casos donde el evento sea diferente: tiempo hasta la infección, tiempo hasta la recaída, etc; la interpretación de la función de supervivencia se torna más difícil. Es por eso que puede ser más intuitivo representar la función de riesgo.Para ello, una vez que fueron definidos los distintos objetos de supervivencia, la función <code>cumhaz</code> en el argumento del gráfico nos permite obtener la función de riesgo acumulado. Veamos un ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-21"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-21-1"><a href="#annotated-cell-21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="annotated-cell-21-2"><a href="#annotated-cell-21-2" aria-hidden="true" tabindex="-1"></a>  kmsex, </span>
<span id="annotated-cell-21-3"><a href="#annotated-cell-21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tmo, </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-21" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-21-4" class="code-annotation-target"><a href="#annotated-cell-21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun=</span> <span class="st">"cumhaz"</span>,</span>
<span id="annotated-cell-21-5"><a href="#annotated-cell-21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,                  </span>
<span id="annotated-cell-21-6"><a href="#annotated-cell-21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> </span>
<span id="annotated-cell-21-7"><a href="#annotated-cell-21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"plum1"</span>, <span class="st">"paleturquoise2"</span>), </span>
<span id="annotated-cell-21-8"><a href="#annotated-cell-21-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          </span>
<span id="annotated-cell-21-9"><a href="#annotated-cell-21-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,              </span>
<span id="annotated-cell-21-10"><a href="#annotated-cell-21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        </span>
<span id="annotated-cell-21-11"><a href="#annotated-cell-21-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="annotated-cell-21-12"><a href="#annotated-cell-21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> </span>
<span id="annotated-cell-21-13"><a href="#annotated-cell-21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Femenino"</span>, <span class="st">"Masculino"</span>),    </span>
<span id="annotated-cell-21-14"><a href="#annotated-cell-21-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>, </span>
<span id="annotated-cell-21-15"><a href="#annotated-cell-21-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()      </span>
<span id="annotated-cell-21-16"><a href="#annotated-cell-21-16" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-21" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-21" data-code-lines="4" data-code-annotation="1">con el argumento <code>cumhaz</code> le indicamos que grafique la función de riesgo</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>De la misma forma, puede procederse para los diferentes objetos de supervivencia creados.</p>
</section>
<section id="bibliografía" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Bibliografía</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hernández-ávila2011" class="csl-entry" role="listitem">
Hernández-Ávila, Mauricio. 2011. <em>Epidemiología: diseño y análisis de estudios</em>. Buenos Aires: Editorial Médica Panamericana.
</div>
<div id="ref-survminer" class="csl-entry" role="listitem">
Kassambara, Alboukadel, Marcin Kosinski, and Przemyslaw Biecek. 2021. <em>Survminer: Drawing Survival Curves Using ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=survminer">https://CRAN.R-project.org/package=survminer</a>.
</div>
<div id="ref-royo2009metodo" class="csl-entry" role="listitem">
Royo-Bordonada, Miguel Angel, Javier Damian, Beatriz Perez-Gomez, Fernando Rodrı́guez-Artalejo, Fernando Villar Alvarez, Gonzalo Lopez-Abente, Iñaki Imaz-Iglesia, et al. 2009. <span>“M<span>é</span>todo Epidemiol<span>ó</span>gico.”</span> Instituto de Salud Carlos III (ISCIII). Escuela Nacional de Sanidad (ENS).
</div>
<div id="ref-survival-book" class="csl-entry" role="listitem">
Terry M. Therneau, and Patricia M. Grambsch. 2000. <em>Modeling Survival Data: Extending the <span>C</span>ox Model</em>. New York: Springer.
</div>
<div id="ref-woodward2005epidemiology" class="csl-entry" role="listitem">
Woodward, M. 2005. <em>Epidemiology: Study Design and Data Analysis</em>. Texts in Statistical Science. Chapman &amp; Hall/CRC. <a href="https://books.google.com.ar/books?id=kcDHxgEACAAJ">https://books.google.com.ar/books?id=kcDHxgEACAAJ</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>